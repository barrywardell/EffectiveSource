/*******************************************************************************
 * Copyright (C) 2012 Barry Wardell
 *
 * Authors: Barry Wardell <effectivesource@barrywardell.net>
 *
 * This program is free software; you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation; either version 2 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston MA 02110-1301, USA.
 *
 * Version 3.0 beta 1 - 30 May 2012
 *
 * This code compute the singular field and effective source for a point scalar
 * particle following an equatorial geodesic orbit in Kerr.
 *
 * Definitions: x is the 4-dimensional location of the field point, xp is the
 *        location of the particle. M is the mass of the background Kerr black
 *        hole. a = J/M is the spin of the black hole in units of M.
 *
 * Usage: Call effsource_init(M, a) at startup to set the mass and spin of the
 *        central black hole.
 *
 *        Call either effsource_set_particle(x_p, u_p) or
 *        effsource_set_particle_el(x_p, e, l, ur_p) every time the particle's
 *        position (x_p), velocity (u_p, ur_p) or constants of motion (e, l) change.
 *
 *        effsource_PhiS(x, *PhiS) stores the value of the singular field in PhiS
 *
 *        effsource_calc(x, *PhiS, *dPhiS_dr, *dPhiS_dth, *dPhiS_dph, *src)
 *        computes the singular field, its spatial derivatives and its
 *        d'Alembertian and stores them in the variables PhiS, dPhiS_dr,
 *        dPhiS_dth, dPhiS_dph and src.
 *
 */

#include <math.h>
#include <assert.h>
#include "effsource.h"
#include <stdio.h>
#include <gsl/gsl_sf_ellint.h>

/* The particle's coordinate location and 4-velocity */
static struct coordinate xp;

/* Mass and spin of the Kerr black hole */
static double M, a;

/* Static variables used to store the coefficients of the series expansions */
static double A006, A008, A024, A026, A042, A044, A060, A062, A080, A106, A108, A124, A126, A142, A144, A160, A162, A180, A204, A206, A222, A224, A240, A242, A260, A304, A306, A322, A324, A340, A342, A360, A402, A404, A420, A422, A440, A502, A504, A520, A522, A540, A600, A602, A620, A700, A702, A720, A800, A900;
static double alpha20, alpha02, beta;

/* Numerical coefficients appearing in the elliptic integrals expressions. The
   indices here correspond to mode m, EllipticK/EllipticE, order in Sin[dphi],
   term in polynomial in alpha/beta. */
static const double EI[11][2][5][17] =
  {
    /* m=0 */
    {
      {
        {0,-0.26666666666666666,-0.5333333333333333,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,-0.06666666666666667,0.2,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0.4,0.13333333333333333,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,1,1.2666666666666666,0.5333333333333333,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,-4,-6.933333333333334,-3.2,0,0,0,0,0,0,0,0,0,0}
      },
      {
        {0.5333333333333333,1.5333333333333334,1.5333333333333334,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0.13333333333333333,0.4666666666666667,-0.2,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0.2,-0.4666666666666667,-0.13333333333333333,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,-1.5333333333333334,-1.5333333333333334,-0.5333333333333333,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,1,6.866666666666666,8.533333333333333,3.2,0,0,0,0,0,0,0,0,0,0}
      }
    },

    /* m=1 */
    {
      {
        {0,-0.26666666666666666,-0.4,-0.4,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,-0.06666666666666667,-0.6,-0.26666666666666666,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,-1.6,-2.4,-1.0666666666666667,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,1,9.266666666666667,14.4,6.4,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,-3.3333333333333335,-24.933333333333334,-38.4,-17.066666666666666,0,0,0,0,0,0,0,0,0}
      },
      {
        {0.5333333333333333,1.2666666666666666,0.6,0.4,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0.13333333333333333,0.06666666666666667,0.7333333333333333,0.26666666666666666,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0.2,2.6,2.933333333333333,1.0666666666666667,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,-3.533333333333333,-15.266666666666667,-17.6,-6.4,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,-0.3333333333333333,10.2,40.93333333333333,46.93333333333333,17.066666666666666,0,0,0,0,0,0,0,0,0}
      }
    },

    /* m=2 */
    {
      {
        {0,-0.26666666666666666,0,1.6,1.0666666666666667,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,-0.06666666666666667,5,9.066666666666666,4.266666666666667,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,-7.6,-42,-59.733333333333334,-25.6,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,1,30.6,128,166.4,68.26666666666667,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,-3.466666666666667,-73.6,-275.2,-341.3333333333333,-136.53333333333333,0,0,0,0,0,0,0,0}
        
      },
      {
        {0.5333333333333333,0.4666666666666667,-0.6,-2.1333333333333333,-1.0666666666666667,0,0,0,0,0,0,0,0,0,0,0,0},{0,0.13333333333333333,-1.1333333333333333,-8.733333333333333,-11.2,-4.266666666666667,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0.2,19.8,67.06666666666666,72.53333333333333,25.6,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,-4.2,-69.8,-198.4,-200.53333333333333,-68.26666666666667,0,0,0,0,0,0,0,0,0},
        {0,0,0,-0.06666666666666667,13.266666666666667,160,420.26666666666665,409.6,136.53333333333333,0,0,0,0,0,0,0,0}
      }
    },

    /* m=3 */
    {
      {
        {0,-0.26666666666666666,0.6666666666666666,-16.4,-34.13333333333333,-17.066666666666666,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,-0.06666666666666667,41,186.4,247.46666666666667,102.4,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,-17.6,-204,-630.4,-716.8,-273.06666666666666,0,0,0,0,0,0,0,0,0},
        {0,0,0,1,65.8,536,1427.2,1501.8666666666666,546.1333333333333,0,0,0,0,0,0,0,0},
        {0,0,0,0,-3.4857142857142858,-153.0857142857143,-1073.3714285714286,-2640.457142857143,-2652.647619047619,-936.2285714285714,0,0,0,0,0,0,0}
      },
      {
        {0.5333333333333333,-0.8666666666666667,2.7333333333333334,30.266666666666666,42.666666666666664,17.066666666666666,0,0,0,0,0,0,0,0,0,0,0},
        {0,0.13333333333333333,-3.1333333333333333,-97.4,-290.93333333333334,-298.6666666666667,-102.4,0,0,0,0,0,0,0,0,0,0},
        {0,0,0.2,53.8,410.4,937.6,853.3333333333334,273.06666666666666,0,0,0,0,0,0,0,0,0},
        {0,0,0,-4.6,-177.4,-1019.2,-2075.733333333333,-1774.9333333333334,-546.1333333333333,0,0,0,0,0,0,0,0},
        {0,0,0,-0.02857142857142857,14.771428571428572,392.62857142857143,1984,3791.2380952380954,3120.7619047619046,936.2285714285714,0,0,0,0,0,0,0}
      }
    },

    /* m=4 */
    {
      {
        {0,-0.26666666666666666,1.6,-198.4,-814.9333333333333,-1024,-409.6,0,0,0,0,0,0,0,0,0,0},
        {0,0,-0.06666666666666667,147.4,1179.7333333333333,3012.266666666667,3072,1092.2666666666667,0,0,0,0,0,0,0,0,0},
        {0,0,0,-31.6,-629.2,-3345.0666666666666,-7116.8,-6553.6,-2184.5333333333333,0,0,0,0,0,0,0,0},
        {0,0,0,1,114.94285714285714,1556.3428571428572,6981.4857142857145,13497.295238095237,11702.857142857143,3744.9142857142856,0,0,0,0,0,0,0},
        {0,0,0,0,-3.492063492063492,-263.84761904761905,-3017.295238095238,-12327.009523809524,-22469.485714285714,-18724.571428571428,-5825.422222222222,0,0,0,0,0,0}
      },
      {
        {0.5333333333333333,-2.7333333333333334,18.6,452.26666666666665,1250.1333333333334,1228.8,409.6,0,0,0,0,0,0,0,0,0,0},
        {0,0.13333333333333333,-5.933333333333334,-401.26666666666665,-2212.266666666667,-4343.466666666666,-3618.133333333333,-1092.2666666666667,0,0,0,0,0,0,0,0,0},
        {0,0,0.2,106.2,1463.3333333333333,5879.466666666666,9984,7645.866666666667,2184.5333333333333,0,0,0,0,0,0,0,0},
        {0,0,0,-4.885714285714286,-344.0857142857143,-3410.5142857142855,-11886.933333333332,-18646.55238095238,-13575.314285714287,-3744.9142857142856,0,0,0,0,0,0,0},
        {0,0,0,-0.015873015873015872,15.806349206349207,753.3714285714286,6407.466666666666,20597.02857142857,30739.504761904762,21637.28253968254,5825.422222222222,0,0,0,0,0,0}
      }
    },

    /* m=5 */
    {
      {
        {0,-0.26666666666666666,2.8,-970,-6314.666666666667,-14080,-13107.2,-4369.066666666667,0,0,0,0,0,0,0,0,0},
        {0,0,-0.06666666666666667,380.2,4689.866666666667,19157.333333333332,34508.8,28398.933333333334,8738.133333333333,0,0,0,0,0,0,0,0},
        {0,0,0,-49.6,-1514.1714285714286,-12285.104761904762,-41442.74285714285,-66823.31428571428,-51180.49523809524,-14979.657142857142,0,0,0,0,0,0,0},
        {0,0,0,1,178.05396825396826,3632.0761904761903,24604.95238095238,74800.76190476191,112737.52380952382,82388.11428571428,23301.68888888889,0,0,0,0,0,0},
        {0,0,0,0,-3.494949494949495,-405.9919191919192,-6920.145454545454,-42364.121212121216,-120645.81818181818,-173769.69696969696,-122863.45050505051,-33893.36565656566,0,0,0,0,0}
        
      },
      {
        {0.5333333333333333,-5.133333333333334,58.2,2479.3333333333335,11306.666666666666,19814.4,15291.733333333334,4369.066666666667,0,0,0,0,0,0,0,0,0},
        {0,0.13333333333333333,-9.533333333333333,-1129.9333333333334,-9986.933333333332,-31906.133333333335,-47069.86666666667,-32768,-8738.133333333333,0,0,0,0,0,0,0,0},
        {0,0,0.2,178.14285714285714,3892.609523809524,24463.390476190478,66662.4,89604.87619047619,58670.32380952381,14979.657142857142,0,0,0,0,0,0,0},
        {0,0,0,-5.1079365079365076,-573.9968253968254,-8815.314285714287,-47328,-117906.28571428571,-149562.51428571428,-94038.95873015873,-23301.68888888889,0,0,0,0,0,0},
        {0,0,0,-0.010101010101010102,16.6,1251.761616161616,16279.660606060606,79786.66666666667,187671.27272727274,228846.41616161616,139810.13333333333,33893.36565656566,0,0,0,0,0}
      }
    },

    /* m=6 */
    {
      {
        {0,-0.26666666666666666,4.266666666666667,-3262.4,-30573.866666666665,-103765.33333333333,-163840,-122333.86666666667,-34952.53333333333,0,0,0,0,0,0,0,0},
        {0,0,-0.06666666666666667,811.4,14256.685714285713,84442.81904761905,231716.57142857142,322998.85714285716,222198.24761904762,59918.62857142857,0,0,0,0,0,0,0},
        {0,0,0,-71.6,-3111.35873015873,-35753.44761904762,-174188.49523809523,-426296.0761904762,-551126.5523809524,-359511.77142857143,-93206.75555555556,0,0,0,0,0,0},
        {0,0,0,1,255.14487734487736,7331.7772005772,69909.00086580086,305560.71341991343,696355.4632034632,856110.1021645021,538057.1797979798,135573.46262626263,0,0,0,0,0},
        {0,0,0,0,-3.4965034965034967,-579.5630147630147,-13824.999533799533,-118555.33053613054,-483592.47365967365,-1.0497981165501166e6,-1.2450923412587412e6,-761297.1362859363,-187717.1020979021,0,0,0,0}
      },
      {
        {0.5333333333333333,-8.066666666666666,135.93333333333334,9026.133333333333,61310.933333333334,166024.53333333333,218453.33333333334,139810.13333333333,34952.53333333333,0,0,0,0,0,0,0,0},
        {0,0.13333333333333333,-13.933333333333334,-2571.1714285714284,-33332.038095238095,-157322.3619047619,-357171.2,-422863.2380952381,-252157.5619047619,-59918.62857142857,0,0,0,0,0,0,0},
        {0,0,0.2,270.5174603174603,8617.873015873016,78308.57142857143,312652.8,643189.0285714286,713406.1714285715,406115.1492063492,93206.75555555556,0,0,0,0,0,0},
        {0,0,0,-5.28975468975469,-870.3079365079365,-19227.160750360752,-147887.70909090908,-536312.6857142857,-1.0362348051948051e6,-1.0997186678210679e6,-605843.911111111,-135573.46262626263,0,0,0,0,0},
        {0,0,0,-0.006993006993006993,17.244910644910647,1895.0315462315461,35180.35244755245,245442.05874125875,836234.2041958042,1.5471995524475526e6,1.5905439527583527e6,855155.6873348873,187717.1020979021,0,0,0,0}
      }
    },

    /* m=7 */
    {
      {
        {0,-0.26666666666666666,6,-8800.4,-111859.80952380953,-531221.9428571429,-1.2414390857142857e6,-1.5322940952380951e6,-958698.0571428571,-239674.51428571428,0,0,0,0,0,0,0},
        {0,0,-0.06666666666666667,1529,36268.93968253968,292742.09523809527,1.1256783238095238e6,2.3227830857142857e6,2.6401645714285714e6,1.557884342857143e6,372827.02222222224,0,0,0,0,0,0},
        {0,0,0,-97.6,-5729.1255411255415,-88548.89927849927,-586570.2510822511,-2.0080116917748917e6,-3.8364944623376625e6,-4.1284842943722946e6,-2.3386422303030305e6,-542293.8505050505,0,0,0,0,0},
        {0,0,0,1,346.2218004218004,13349.73026973027,170513.0474858475,1.0105419870795871e6,3.214343297236097e6,5.829024556243756e6,6.033182035742036e6,3.3163354703962705e6,750868.4083916084,0,0,0,0},
        {0,0,0,0,-3.4974358974358974,-784.5839937839938,-25005.26247086247,-286327.7053613054,-1.5797995114219114e6,-4.77710082983683e6,-8.342656417715617e6,-8.387304409013209e6,-4.50521045034965e6,-1.0011578778554779e6,0,0,0}
      },
      {
        {0.5333333333333333,-11.533333333333333,269.4,25857.619047619046,244643.3523809524,941524.1142857143,1.8502997333333334e6,1.9667041523809524e6,1.0785353142857142e6,239674.51428571428,0,0,0,0,0,0,0},
        {0,0.13333333333333333,-19.133333333333333,-5094.479365079365,-91148.63492063493,-595972.8761904762,-1.9178837333333334e6,-3.3857145904761907e6,-3.3492016761904764e6,-1.744297853968254e6,-372827.02222222224,0,0,0,0,0,0},
        {0,0,0.2,384.0510822510823,16824.368253968252,209062.3953823954,1.1501940363636364e6,3.3420239238095237e6,5.513081239826839e6,5.196125312554113e6,2.6097891555555556e6,542293.8505050505,0,0,0,0,0},
        {0,0,0,-5.443600843600843,-1235.5986901986903,-37219.1333999334,-389168.827972028,-1.9364873206793207e6,-5.267843912887113e6,-8.294196586702187e6,-7.550561944366745e6,-3.6917696745920745e6,-750868.4083916084,0,0,0,0},
        {0,0,0,-0.005128205128205128,17.78850038850039,2689.031546231546,67733.57202797203,639727.53006993,2.9806964363636365e6,7.743910966899767e6,1.1785440213830614e7,1.0452192532090131e7,5.005789389277389e6,1.0011578778554779e6,0,0,0}
      }
    },

    /* m=8 */
    {
      {
        {0,-0.26666666666666666,8,-20454.4,-338221.5111111111,-2.129646933333333e6,-6.821751466666667e6,-1.2233386666666666e7,-1.2443101866666667e7,-6.7108864e6,-1.491308088888889e6,0,0,0,0,0,0},
        {0,0,-0.06666666666666667,2637,81197.69581529581,855236.9685425685,4.365921080519481e6,1.2354614081385281e7,2.0404108744588744e7,1.9569787234632034e7,1.0100222965656566e7,2.169175402020202e6,0,0,0,0,0},
        {0,0,0,-127.6,-9731.779553779554,-194743.272016872,-1.6810041968697968e6,-7.631895255677655e6,-1.9979235561238762e7,-3.121355504229104e7,-2.8716805848018646e7,-1.4349929582595183e7,-3.0034736335664336e6,0,0,0,0},
        {0,0,0,1,451.2884670884671,22506.019314019315,371138.143989344,2.8608340821844824e6,1.2051529176956376e7,2.991034232967033e7,4.489893256254856e7,4.0046315114219114e7,1.9522578618181817e7,4.0046315114219114e6,0,0,0},
        {0,0,0,0,-3.4980392156862745,-1021.0684583390466,-41964.88205128205,-619011.4680926916,-4.434788679994515e6,-1.7736541547237076e7,-4.234410989606472e7,-6.1679177494547285e7,-5.3709175564952694e7,-2.5676754984999314e7,-5.182464308898944e6,0,0}
      },
      {
        {0.5333333333333333,-15.533333333333333,479.4,63067.02222222222,792570.3111111111,4.1009152e6,1.1153681066666666e7,1.7336456533333335e7,1.55189248e7,7.456540444444444e6,1.491308088888889e6,0,0,0,0,0,0},
        {0,0.13333333333333333,-25.133333333333333,-9153.99163059163,-216262.70476190475,-1.870872972005772e6,-8.079372412121212e6,-1.9716661638095237e7,-2.849857074978355e7,-2.421317832958153e7,-1.1184810666666666e7,-2.169175402020202e6,0,0,0,0,0},
        {0,0,0.2,519.3591075591075,29973.258252858253,488692.7529359529,3.5444105846153847e6,1.3786808101764902e7,3.138413195977356e7,4.3162921822710626e7,3.5328619333022535e7,1.58516663993784e7,3.0034736335664336e6,0,0,0,0},
        {0,0,0,-5.576934176934177,-1672.0434454434455,-65967.23223443223,-901384.234965035,-5.895572075924076e6,-2.1422238766033966e7,-4.646431837318237e7,-6.163704083294483e7,-4.905673601491842e7,-2.1524894373892773e7,-4.0046315114219114e6,0,0,0},
        {0,0,0,-0.00392156862745098,18.25848530554413,3638.6809634809633,119650.73401892226,1.4725623786096256e6,8.997631810448375e6,3.1165726124667488e7,6.523953848801134e7,8.420522974629554e7,6.55758409995338e7,2.8267987139448788e7,5.182464308898944e6,0,0}
      }
    },

    /* m=9 */
    {
      {
        {0,-0.26666666666666666,10.266666666666667,-42656.4,-889373.995959596,-7.149019797979798e6,-2.9865748169696968e7,-7.235293556363636e7,-1.0554394065454546e8,-9.146124722424242e7,-4.3383508040404044e7,-8.676701608080808e6,0,0,0,0,0},
        {0,0,-0.06666666666666667,4255.4,165053.57016317017,2.19670492991453e6,1.4330180624708625e7,5.29140260997669e7,1.1808499516270396e8,1.624359102955711e8,1.346948423011655e8,6.173806913442113e7,1.2013894534265734e7,0,0,0,0},
        {0,0,0,-161.6,-15539.587434787434,-390961.72201132204,-4.259990718614719e6,-2.4699115148318347e7,-8.432809336796537e7,-1.779399951088911e8,-2.3469069971592852e8,-1.8834282577156177e8,-8.409726173986015e7,-1.6018526045687646e7,0,0,0},
        {0,0,0,1,570.3472906178788,35746.582191664544,739622.7686979687,7.187172049660143e6,3.862786977665472e7,1.249378262920452e8,2.5314112267361397e8,3.234930047362311e8,2.531309910877828e8,1.1071628296284108e8,2.0729857235595778e7,0,0},
        {0,0,0,0,-3.498452012383901,-1289.0251146857959,-66438.47422257825,-1.227617738434115e6,-1.107397992473244e7,-5.645272137256345e7,-1.7550347663965014e8,-3.4482027794523466e8,-4.29947715579034e8,-3.2974049077368206e8,-1.4183586529618162e8,-2.6185082823910456e7,0}
      },{
        {0.5333333333333333,-20.066666666666666,789.9333333333333,136892.39191919193,2.2055480888888887e6,1.4743798173737373e7,5.277455204848485e7,1.1157285546666667e8,1.4395359728484848e8,1.115261196929293e8,4.7721858844444446e7,8.676701608080808e6,0,0,0,0,0},
        {0,0.13333333333333333,-31.933333333333334,-15290.940326340326,-461269.8076146076,-5.10054407956488e6,-2.841850342937063e7,-9.11948410927739e7,-1.7918446766247088e8,-2.193337460960373e8,-1.6331127164320123e8,-6.7745016401554e7,-1.2013894534265734e7,0,0,0,0},
        {0,0,0.2,676.9748695748696,49810.32203352203,1.0321920394272394e6,9.544164072727272e6,4.781388058341658e7,1.4294413774385613e8,2.6698699182559663e8,3.145956128422688e8,2.2738798300792542e8,9.210652476270397e7,1.6018526045687646e7,0,0,0},
        {0,0,0,-5.694581235757706,-2181.5221419103773,-109270.05492285492,-1.892202578033731e6,-1.5744906345607335e7,-7.356716086097433e7,-2.0929734465833253e8,-3.7668167367356825e8,-4.312426213404269e8,-3.046022843375291e8,-1.2108121158063897e8,-2.0729857235595778e7,0,0},
        {0,0,0,-0.0030959752321981426,18.672520393263426,4748.226915980476,197766.84242568578,3.0782871159107145e6,2.3888763615371626e7,1.062565981512135e8,2.914255876520172e8,5.098456950542433e8,5.706785877375826e8,3.9574872039228964e8,1.5492840670813686e8,2.6185082823910456e7,0}
      }
    },
    
    /* m=10 */
    {
      {
        {0,-0.26666666666666666,12.8,-81880,-2.1007407614607615e6,-2.095521238228438e7,-1.1023046737156177e8,-3.441285888596737e8,-6.709847600932401e8,-8.259552492307693e8,-6.240550771965812e8,-2.6430567975384617e8,-4.805557813706294e7,0,0,0,0},
        {0,0,-0.06666666666666667,6520.2,311067.7942501943,5.102019779331779e6,4.133440304335664e7,1.922698987114219e8,5.530782550526806e8,1.0170620137920746e9,1.1980522605003884e9,8.746782659530692e8,3.6041683602797204e8,6.407410418275058e7,0,0,0},
        {0,0,0,-199.6,-23628.784478266833,-730166.5007724302,-9.797468315151514e6,-7.051502323959962e7,-3.0318843028131086e8,-8.24417740343672e8,-1.4532290842782943e9,-1.6563077409054527e9,-1.1777150141972852e9,-4.749021839427396e8,-8.291942894238311e7,0,0},
        {0,0,0,1,703.3999221968262,54143.24552805296,1.3738612902969064e6,1.6423980970872264e7,1.0950013007528281e8,4.457761957446739e8,1.1633972193432798e9,1.9862208061391819e9,2.20653026587352e9,1.5363898975089884e9,6.088031756559181e8,1.0474033129564182e8,0},
        {0,0,0,0,-3.49874686716792,-1588.4598780648316,-100391.40281967774,-2.2721153274630425e6,-2.5192147588914696e7,-1.5919834323671788e8,-6.225945846062396e8,-1.5748847121862333e9,-2.622330288934644e9,-2.854181112514796e9,-1.9537500785578425e9,-7.631081280111047e8,-1.2967850541365178e8}
      },{
        {0.5333333333333333,-25.133333333333333,1228.2,271881.5229215229,5.463605097125097e6,4.5788857465734266e7,2.0806943674778554e8,5.705886187710955e8,9.891261404195805e8,1.0929306833255634e9,7.47197496172805e8,2.883334688223776e8,4.805557813706294e7,0,0,0,0},
        {0,0.13333333333333333,-39.53333333333333,-24135.788500388502,-905518.1986013986,-1.2458983344832946e7,-8.693429073752914e7,-3.539285428811189e8,-9.016469155505828e8,-1.4824022811648796e9,-1.5738201839888113e9,-1.0428727894327894e9,-3.9245388811934733e8,-6.407410418275058e7,0,0,0},
        {0,0,0.2,857.3689565336624,78373.47438182733,2.0127715456099457e6,2.3112727872974087e7,1.448205784474976e8,5.48772786971836e8,1.3280004404618127e9,2.1005893010457883e9,2.16389478497818e9,1.3996187132419581e9,5.163618984139312e8,8.291942894238311e7,0,0},
        {0,0,0,-5.799844393652443,-2765.6909199503625,-171565.7852751995,-3.67408829080517e6,-3.790738907893345e7,-2.2126713741740116e8,-7.971567635483366e8,-1.8574286571222606e9,-2.852811286882909e9,-2.870394025251496e9,-1.8211526732190146e9,-6.61173341303739e8,-1.0474033129564182e8,0},
        {0,0,0,-0.002506265664160401,19.04256314720711,6021.407418450143,310071.7180627422,5.959559314048181e6,5.72743914936333e7,3.179286576710175e8,1.1032734622114787e9,2.4971591341437187e9,3.7476056187814e9,3.700130737674165e9,2.310989422798335e9,8.279473807179306e8,1.2967850541365178e8}
      }
    }
  };

/* Compute the singular field at the point x for the particle at xp */
void effsource_PhiS(struct coordinate * x, double * PhiS)
{

  double A, alpha, rho2;

  double r      = x->r;
  double theta  = x->theta;
  double phi    = x->phi;
  double rp     = xp.r;
  double thetap = xp.theta;
  double phip   = xp.phi;

  double dr     = r - rp;
  double dtheta = theta - thetap;
  double dphi   = phi - phip;

  double dr2 = dr*dr;
  double dr3 = dr2*dr;
  double dr4 = dr2*dr2;
  double dr6 = dr3*dr3;
  double dr8 = dr4*dr4;

  double dtheta2  = dtheta*dtheta;
  double dtheta4  = dtheta2*dtheta2;
  double dtheta8  = dtheta4*dtheta4;
  
  double sindphi  = sin(0.5*dphi);
  double sindphi2 = sindphi*sindphi;
  double sindphi4 = sindphi2*sindphi2;
  double sindphi8 = sindphi4*sindphi4;

  A = dr6*(A600 + A700*dr) + dr8*(A800 + A900*dr) + dr4*(A420 + A520*dr + dr2*(A620 + A720*dr))*dtheta2 + 
   (A080 + A180*dr)*dtheta8 + dtheta4*(dr2*(A240 + A340*dr) + dr4*(A440 + A540*dr) + 
      (A060 + A160*dr + dr2*(A260 + A360*dr))*dtheta2) + 
   (dr4*(A402 + A502*dr + dr2*(A602 + A702*dr)) + (dr2*(A222 + A322*dr) + dr4*(A422 + A522*dr))*dtheta2 + 
      dtheta4*(A042 + A142*dr + dr2*(A242 + A342*dr) + (A062 + A162*dr)*dtheta2))*sindphi2 + 
   (A008 + A108*dr)*sindphi8 + sindphi4*(dr2*(A204 + A304*dr) + dr4*(A404 + A504*dr) + 
      (A024 + A124*dr + dr2*(A224 + A324*dr))*dtheta2 + (A044 + A144*dr)*dtheta4 + 
      (A006 + A106*dr + dr2*(A206 + A306*dr) + (A026 + A126*dr)*dtheta2)*sindphi2);

  alpha = alpha20*dr2 + alpha02*dtheta2;
  rho2 = alpha + beta*sindphi2;

  *PhiS = A/pow(rho2, 3.5);
}

/* Compute the singular field at the point x for the particle at xp */
void effsource_PhiS_m(int m, struct coordinate * x, double * PhiS)
{
  double A[5], num, alpha, ellE, ellK;

  double r      = x->r;
  const double theta  = x->theta;
  const double rp     = xp.r;
  const double thetap = xp.theta;

  const double dr     = r - rp;
  const double dtheta = theta - thetap;

  const double dr2 = dr*dr;
  const double dr3 = dr2*dr;
  const double dr4 = dr2*dr2;
  const double dr6 = dr3*dr3;
  const double dr8 = dr4*dr4;

  const double dtheta2  = dtheta*dtheta;
  const double dtheta4  = dtheta2*dtheta2;
  const double dtheta8  = dtheta4*dtheta4;

  A[0] = dr6*(A600 + A700*dr) + dr8*(A800 + A900*dr) + dr4*(A420 + A520*dr + dr2*(A620 + A720*dr))*dtheta2 + (A080 + A180*dr)*dtheta8 + dtheta4*(dr2*(A240 + A340*dr) + dr4*(A440 + A540*dr) + (A060 + A160*dr + dr2*(A260 + A360*dr))*dtheta2);
  A[1] = dr4*(A402 + A502*dr + dr2*(A602 + A702*dr)) + (dr2*(A222 + A322*dr) + dr4*(A422 + A522*dr))*dtheta2 + dtheta4*(A042 + A142*dr + dr2*(A242 + A342*dr) + (A062 + A162*dr)*dtheta2);
  A[2] = dr2*(A204 + A304*dr) + dr4*(A404 + A504*dr) + (A024 + A124*dr + dr2*(A224 + A324*dr))*dtheta2 + (A044 + A144*dr)*dtheta4;
  A[3] = A006 + A106*dr + dr2*(A206 + A306*dr) + (A026 + A126*dr)*dtheta2;
  A[4] = A008 + A108*dr;

  alpha = alpha20*dr2 + alpha02*dtheta2;

  const double C1 = alpha / beta;

  double C[17];
  C[0]  = 1;
  C[1]  = C1;
  C[2]  = C[1]*C[1];
  C[3]  = C[2]*C[1];
  C[4]  = C[2]*C[2];
  C[5]  = C[3]*C[2];
  C[6]  = C[3]*C[3];
  C[7]  = C[4]*C[3];
  C[8]  = C[4]*C[4];
  C[9]  = C[5]*C[4];
  C[10] = C[5]*C[5];
  C[11] = C[6]*C[5];
  C[12] = C[6]*C[6];
  C[13] = C[7]*C[6];
  C[14] = C[7]*C[7];
  C[15] = C[8]*C[7];
  C[16] = C[8]*C[8];

  ellE = gsl_sf_ellint_Ecomp(sqrt(1.0/(1.0+C1)), GSL_PREC_DOUBLE);
  ellK = gsl_sf_ellint_Kcomp(sqrt(1.0/(1.0+C1)), GSL_PREC_DOUBLE);
  const double ellip[2] = {ellK, ellE};

  if(m>10)
  {
    printf("Support for computing mode %d has not yet been added.\n", m);
    return;
  }

  num = 0;
  for(int i=0; i<2; i++)
    for(int j=0; j<5; j++)
      for(int k=0; k<17; k++)
        num += EI[m][i][j][k]*ellip[i]*A[j]*C[k];

  PhiS[0] = 4.0*num/(beta*C[3]*pow(alpha+beta, 2.5));
  PhiS[1] = 0;
}

/* Compute the singular field, its derivatives and its d'Alembertian */
void effsource_calc(struct coordinate * x,
  double *PhiS, double *dPhiS_dx, double *d2PhiS_dx2, double *src)
{
  double A, dA_dr, d2A_dr2, dA_dth, d2A_dth2, dA_dR, dA_dph,  d2A_dR2,  d2A_dph2, dA_dt, d2A_dt2, d2A_dphdt;
  double s2, sqrts2, s2_15, s2_25, s2_35, s2_45, s2_55, ds2_dr, d2s2_dr2, ds2_dth, d2s2_dth2, ds2_dR, ds2_dph, d2s2_dR2, d2s2_dph2, ds2_dt, d2s2_dt2, d2s2_dphdt;

  double dPhiS_dt, dPhiS_dr, dPhiS_dth, dPhiS_dph, d2PhiS_dt2, d2PhiS_dtr, d2PhiS_dtth;
  double d2PhiS_dtph, d2PhiS_dr2, d2PhiS_drth, d2PhiS_drph, d2PhiS_dth2, d2PhiS_dthph, d2PhiS_dph2;

  double r      = x->r;
  double theta  = x->theta;
  double phi    = x->phi;
  double rp     = xp.r;
  double thetap = xp.theta;
  double phip   = xp.phi;

  double dr     = r - rp;
  double dtheta = theta - thetap;
  double dphi   = phi - phip;

  double dr2      = dr*dr;
  double dr3      = dr2*dr;
  double dr4      = dr2*dr2;
  double dr5      = dr3*dr2;
  double dr6      = dr3*dr3;
  double dr7      = dr4*dr3;
  double dr8      = dr4*dr4;

  double dtheta2  = dtheta*dtheta;
  double dtheta3  = dtheta2*dtheta;
  double dtheta4  = dtheta2*dtheta2;
  double dtheta5  = dtheta3*dtheta2;
  double dtheta6  = dtheta3*dtheta3;
  double dtheta7  = dtheta4*dtheta3;
  double dtheta8  = dtheta4*dtheta4;

  double R        = sin(0.5*dphi);
  double R2       = R*R;
  double R3       = R2*R;
  double R4       = R2*R2;
  double R5       = R3*R2;
  double R6       = R3*R3;
  double R7       = R4*R3;
  double R8       = R4*R4;
  double dR       = 0.5*cos(0.5*dphi);

  double om       = M / (a*M + sqrt(M*pow(rp,3)));

  /* A, dA/dx, d^2A/dx^2 */
  A         = dr6*(A600 + A700*dr) + dr8*(A800 + A900*dr) + dr4*(A420 + A520*dr + dr2*(A620 + A720*dr))*dtheta2 + (A080 + A180*dr)*dtheta8 + dtheta4*(dr2*(A240 + A340*dr) + dr4*(A440 + A540*dr) + (A060 + A160*dr + dr2*(A260 + A360*dr))*dtheta2) + (dr4*(A402 + A502*dr + dr2*(A602 + A702*dr)) + (dr2*(A222 + A322*dr) + dr4*(A422 + A522*dr))*dtheta2 + dtheta4*(A042 + A142*dr + dr2*(A242 + A342*dr) + (A062 + A162*dr)*dtheta2))*R2 + (A008 + A108*dr)*R8 + R4*(dr2*(A204 + A304*dr) + dr4*(A404 + A504*dr) + (A024 + A124*dr + dr2*(A224 + A324*dr))*dtheta2 + (A044 + A144*dr)*dtheta4 + (A006 + A106*dr + dr2*(A206 + A306*dr) + (A026 + A126*dr)*dtheta2)*R2);;
  dA_dr     = 6*(A600 + A700*dr)*dr5 + A700*dr6 + 8*(A800 + A900*dr)*dr7 + A900*dr8 + 4*(A420 + A520*dr + (A620 + A720*dr)*dr2)*dr3*dtheta2 + (A520 + 2*dr*(A620 + A720*dr) + A720*dr2)*dr4*dtheta2 + (2*dr*(A240 + A340*dr) + A340*dr2 + 4*(A440 + A540*dr)*dr3 + A540*dr4 + (A160 + 2*dr*(A260 + A360*dr) + A360*dr2)*dtheta2)*dtheta4 + A180*dtheta8 + (4*(A402 + A502*dr + (A602 + A702*dr)*dr2)*dr3 + (A502 + 2*dr*(A602 + A702*dr) + A702*dr2)*dr4 + (2*dr*(A222 + A322*dr) + A322*dr2 + 4*(A422 + A522*dr)*dr3 + A522*dr4)* dtheta2 + (A142 + 2*dr*(A242 + A342*dr) + A342*dr2 + A162*dtheta2)* dtheta4)*R2 + (2*dr*(A204 + A304*dr) + A304*dr2 + 4*(A404 + A504*dr)*dr3 + A504*dr4 + (A124 + 2*dr*(A224 + A324*dr) + A324*dr2)*dtheta2 + A144*dtheta4 + (A106 + 2*dr*(A206 + A306*dr) + A306*dr2 + A126*dtheta2)*R2)* R4 + A108*R8;
  dA_dth    = 2*(A420 + A520*dr + (A620 + A720*dr)*dr2)*dr4*dtheta + 4*((A240 + A340*dr)*dr2 + (A440 + A540*dr)*dr4 + (A060 + A160*dr + (A260 + A360*dr)*dr2)*dtheta2)*dtheta3 + 2*(A060 + A160*dr + (A260 + A360*dr)*dr2)*dtheta5 + 8*(A080 + A180*dr)*dtheta7 + (2*((A222 + A322*dr)*dr2 + (A422 + A522*dr)*dr4)*dtheta + 4*(A042 + A142*dr + (A242 + A342*dr)*dr2 + (A062 + A162*dr)*dtheta2)* dtheta3 + 2*(A062 + A162*dr)*dtheta5)*R2 + (2*(A024 + A124*dr + (A224 + A324*dr)*dr2)*dtheta + 4*(A044 + A144*dr)*dtheta3 + 2*(A026 + A126*dr)*dtheta*R2)* R4;
  dA_dR     = 2*((A402 + A502*dr + (A602 + A702*dr)*dr2)*dr4 + ((A222 + A322*dr)*dr2 + (A422 + A522*dr)*dr4)*dtheta2 + (A042 + A142*dr + (A242 + A342*dr)*dr2 + (A062 + A162*dr)*dtheta2)* dtheta4)*R + 4*((A204 + A304*dr)*dr2 + (A404 + A504*dr)*dr4 + (A024 + A124*dr + (A224 + A324*dr)*dr2)*dtheta2 + (A044 + A144*dr)*dtheta4 + (A006 + A106*dr + (A206 + A306*dr)*dr2 + (A026 + A126*dr)*dtheta2)* R2)*R3 + 2*(A006 + A106*dr + (A206 + A306*dr)*dr2 + (A026 + A126*dr)*dtheta2)*R5 + 8*(A008 + A108*dr)*R7;
  dA_dph    = dA_dR*dR;
  dA_dt     = -om*dA_dph;
  d2A_dr2   = 30*(A600 + A700*dr)*dr4 + 12*A700*dr5 + 56*(A800 + A900*dr)*dr6 + 16*A900*dr7 + 12*dr2*(A420 + A520*dr + (A620 + A720*dr)*dr2)*dtheta2 + 8*(A520 + 2*dr*(A620 + A720*dr) + A720*dr2)*dr3*dtheta2 + (4*A720*dr + 2*(A620 + A720*dr))*dr4*dtheta2 + (4*A340*dr + 2*(A240 + A340*dr) + 12*(A440 + A540*dr)*dr2 + 8*A540*dr3 + (4*A360*dr + 2*(A260 + A360*dr))*dtheta2)*dtheta4 + (12*dr2*(A402 + A502*dr + (A602 + A702*dr)*dr2) + 8*(A502 + 2*dr*(A602 + A702*dr) + A702*dr2)*dr3 + (4*A702*dr + 2*(A602 + A702*dr))*dr4 + (4*A322*dr + 2*(A222 + A322*dr) + 12*(A422 + A522*dr)*dr2 + 8*A522*dr3)*dtheta2 + (4*A342*dr + 2*(A242 + A342*dr))*dtheta4)* R2 + (4*A304*dr + 2*(A204 + A304*dr) + 12*(A404 + A504*dr)*dr2 + 8*A504*dr3 + (4*A324*dr + 2*(A224 + A324*dr))*dtheta2 + (4*A306*dr + 2*(A206 + A306*dr))*R2)*R4;
  d2A_dth2  = 2*(A420 + A520*dr + (A620 + A720*dr)*dr2)*dr4 + 12*dtheta2*((A240 + A340*dr)*dr2 + (A440 + A540*dr)*dr4 + (A060 + A160*dr + (A260 + A360*dr)*dr2)*dtheta2) + 18*(A060 + A160*dr + (A260 + A360*dr)*dr2)*dtheta4 + 56*(A080 + A180*dr)*dtheta6 + (2*((A222 + A322*dr)*dr2 + (A422 + A522*dr)*dr4) + 12*dtheta2*(A042 + A142*dr + (A242 + A342*dr)*dr2 +  (A062 + A162*dr)*dtheta2) + 18*(A062 + A162*dr)*dtheta4)*R2 + (2*(A024 + A124*dr + (A224 + A324*dr)*dr2) + 12*(A044 + A144*dr)*dtheta2 + 2*(A026 + A126*dr)*R2)*R4; d2A_dR2 = 2*((A402 + A502*dr + (A602 + A702*dr)*dr2)*dr4 + ((A222 + A322*dr)*dr2 + (A422 + A522*dr)*dr4)*dtheta2 + (A042 + A142*dr + (A242 + A342*dr)*dr2 + (A062 + A162*dr)*dtheta2)* dtheta4) + 12*R2*((A204 + A304*dr)*dr2 + (A404 + A504*dr)*dr4 + (A024 + A124*dr + (A224 + A324*dr)*dr2)*dtheta2 + (A044 + A144*dr)*dtheta4 + (A006 + A106*dr + (A206 + A306*dr)*dr2 + (A026 + A126*dr)*dtheta2)* R2) + 18*(A006 + A106*dr + (A206 + A306*dr)*dr2 + (A026 + A126*dr)*dtheta2)*R4 + 56*(A008 + A108*dr)*R6;
  d2A_dph2  = - 0.25*R*dA_dR + dR*dR*d2A_dR2;
  d2A_dt2   = om*om*d2A_dph2;
  d2A_dphdt = -om*d2A_dph2;

  /* s, ds/dr, d^2s/dr^2 */
  s2         = alpha20*dr2 + alpha02*dtheta2 + beta*R2;
  ds2_dr     = 2*alpha20*dr;
  ds2_dth    = 2*alpha02*dtheta;
  ds2_dR     = 2*beta*R;
  ds2_dph    = ds2_dR*dR;
  ds2_dt     = -om*ds2_dph;
  d2s2_dr2   = 2*alpha20;
  d2s2_dth2  = 2*alpha02;
  d2s2_dR2   = 2*beta;
  d2s2_dph2  = - 0.25*R*ds2_dR + dR*dR*d2s2_dR2;
  d2s2_dt2   = om*om*d2s2_dph2;
  d2s2_dphdt = -om*d2s2_dph2;
  sqrts2     = sqrt(s2);
  s2_15      = s2*sqrts2;
  s2_25      = s2*s2_15;
  s2_35      = s2*s2_25;
  s2_45      = s2*s2_35;
  s2_55      = s2*s2_45;

  /* PhiS */
  *PhiS = A/s2_35;

  /* First derivatives of PhiS */
  dPhiS_dt  = (-7*ds2_dt*A + 2*dA_dt*s2)/(2.*s2_45);
  dPhiS_dr  = (-7*ds2_dr*A + 2*dA_dr*s2) /(2.*s2_45);
  dPhiS_dth = (-7*ds2_dth*A + 2*dA_dth*s2)/(2.*s2_45);
  dPhiS_dph = (-7*ds2_dph*A + 2*dA_dph*s2)/(2.*s2_45);
  
  /* Second derivatives of PhiS */
  d2PhiS_dr2 =
    (63*ds2_dr*ds2_dr*A - 14*s2*(2*dA_dr*ds2_dr + d2s2_dr2*A) + 4*d2A_dr2*s2*s2)/(4.*s2_55);
  d2PhiS_dth2 =
    (63*ds2_dth*ds2_dth*A - 14*s2*(2*dA_dth*ds2_dth + d2s2_dth2*A) + 4*d2A_dth2*s2*s2)/(4.*s2_55);
  d2PhiS_dph2 =
    (63*ds2_dph*ds2_dph*A - 14*s2*(2*dA_dph*ds2_dph + d2s2_dph2*A) + 4*d2A_dph2*s2*s2)/(4.*s2_55);
  d2PhiS_dt2 =
    (63*ds2_dt*ds2_dt*A - 14*s2*(2*dA_dt*ds2_dt + d2s2_dt2*A) + 4*d2A_dt2*s2*s2)/(4.*s2_55);
  d2PhiS_dtph =
    (63*ds2_dph*ds2_dt*A - 14*s2*(dA_dt*ds2_dph + dA_dph*ds2_dt + d2s2_dphdt*A) + 4*d2A_dphdt*s2*s2)/(4.*s2_55);
  d2PhiS_dtr   = NAN;
  d2PhiS_dtth  = NAN;
  d2PhiS_drth  = NAN;
  d2PhiS_drph  = NAN;
  d2PhiS_dthph = NAN;
  
  
  /* Box[PhiS] */
  double sinth  = sin(theta);
  double sinth2 = sinth*sinth;
  double sin2th = sin(2*theta);
  double cos2th = cos(2*theta);
  double r2 = r*r;
  double r3 = r2*r;
  double r4 = r2*r2;
  double a2 = a*a;
  double a4 = a2*a2;

  *src = -((2*a2*dPhiS_dr - a2*d2PhiS_dph2 - a4*d2PhiS_dr2 - a2*d2PhiS_dth2 - 4*dPhiS_dr*r - 2*a2*dPhiS_dr*r +
         4*d2PhiS_dph2*r + 2*a*d2PhiS_dtph*r + 4*a2*d2PhiS_dr2*r + 2*d2PhiS_dth2*r + 6*dPhiS_dr*r2 - 2*d2PhiS_dph2*r2 - 4*d2PhiS_dr2*r2 -
         2*a2*d2PhiS_dr2*r2 - d2PhiS_dth2*r2 - 2*dPhiS_dr*r3 + 4*d2PhiS_dr2*r3 - d2PhiS_dr2*r4 +
         (a4*d2PhiS_dt2 + 4*a*d2PhiS_dtph*r + 2*d2PhiS_dt2*r4 + a2*d2PhiS_dt2*r*(2 + 3*r))*sinth2 +
         cos2th*(a4*d2PhiS_dr2 - 2*a*d2PhiS_dtph*r + (-2 + r)*r*(d2PhiS_dth2 + 2*dPhiS_dr*(-1 + r) + d2PhiS_dr2*(-2 + r)*r) +
            a2*(-d2PhiS_dph2 + d2PhiS_dth2 + 2*dPhiS_dr*(-1 + r) - 4*d2PhiS_dr2*r + 2*d2PhiS_dr2*r2) +
            a2*d2PhiS_dt2*(a2 + (-2 + r)*r)*sinth2) - a2*dPhiS_dth*sin2th + 2*dPhiS_dth*r*sin2th -
         dPhiS_dth*r2*sin2th))/((sinth2*(a2 + (-2 + r)*r)*(a2 + 2*r2 + a2*cos2th)));

  dPhiS_dx[0] = dPhiS_dt;
  dPhiS_dx[1] = dPhiS_dr;
  dPhiS_dx[2] = dPhiS_dth;
  dPhiS_dx[3] = dPhiS_dph;

  d2PhiS_dx2[0] = d2PhiS_dt2;
  d2PhiS_dx2[1] = d2PhiS_dtr;
  d2PhiS_dx2[2] = d2PhiS_dtth;
  d2PhiS_dx2[3] = d2PhiS_dtph;
  d2PhiS_dx2[4] = d2PhiS_dr2;
  d2PhiS_dx2[5] = d2PhiS_drth;
  d2PhiS_dx2[6] = d2PhiS_drph;
  d2PhiS_dx2[7] = d2PhiS_dth2;
  d2PhiS_dx2[8] = d2PhiS_dthph;
  d2PhiS_dx2[9] = d2PhiS_dph2;
}

/* Compute the 2D singular field, its derivatives and its d'Alembertian */
void effsource_calc_m(int m, struct coordinate * x,
  double *PhiS, double *dPhiS_dx, double *d2PhiS_dx2, double *src)
{
  double A[5], alpha, ellE, ellK;
  double dA_dr[5], dalpha_dr, dC1_dr, dellE_dC, dellK_dC, d2ellE_dC2, d2ellK_dC2, dellE_dr, dellK_dr;
  double d2A_dr2[5], d2alpha_dr2, d2C1_dr2, d2ellE_dr2, d2ellK_dr2;
  double dA_dtheta[5], dalpha_dtheta, dC1_dtheta, dellE_dtheta, dellK_dtheta;
  double d2A_dtheta2[5], d2alpha_dtheta2, d2C1_dtheta2, d2ellE_dtheta2, d2ellK_dtheta2;

  double s, ds_dr, d2s_dr2, ds_dtheta, d2s_dtheta2;

  double dPhiS_dt, dPhiS_dr, dPhiS_dth, dPhiS_dph, d2PhiS_dt2, d2PhiS_dtr, d2PhiS_dtth;
  double d2PhiS_dtph, d2PhiS_dr2, d2PhiS_drth, d2PhiS_drph, d2PhiS_dth2, d2PhiS_dthph, d2PhiS_dph2;

  const double r      = x->r;
  const double theta  = x->theta;
  const double rp     = xp.r;
  const double thetap = xp.theta;
  const double om       = M / (a*M + sqrt(M*pow(rp,3)));

  const double dr     = r - rp;
  const double dtheta = theta - thetap;

  const double dr2 = dr*dr;
  const double dr3 = dr2*dr;
  const double dr4 = dr2*dr2;
  const double dr5 = dr3*dr2;
  const double dr6 = dr3*dr3;
  const double dr7 = dr4*dr3;
  const double dr8 = dr4*dr4;

  const double dtheta2  = dtheta*dtheta;
  const double dtheta3  = dtheta2*dtheta;
  const double dtheta4  = dtheta2*dtheta2;
  const double dtheta5  = dtheta3*dtheta2;
  const double dtheta6  = dtheta3*dtheta3;
  const double dtheta7  = dtheta4*dtheta3;
  const double dtheta8  = dtheta4*dtheta4;

  /* Coefficients of sin(dphi) in the numerator */
  A[0] = dr6*(A600 + A700*dr) + dr8*(A800 + A900*dr) + dr4*(A420 + A520*dr + dr2*(A620 + A720*dr))*dtheta2 + (A080 + A180*dr)*dtheta8 + dtheta4*(dr2*(A240 + A340*dr) + dr4*(A440 + A540*dr) + (A060 + A160*dr + dr2*(A260 + A360*dr))*dtheta2);
  A[1] = dr4*(A402 + A502*dr + dr2*(A602 + A702*dr)) + (dr2*(A222 + A322*dr) + dr4*(A422 + A522*dr))*dtheta2 + dtheta4*(A042 + A142*dr + dr2*(A242 + A342*dr) + (A062 + A162*dr)*dtheta2);
  A[2] = dr2*(A204 + A304*dr) + dr4*(A404 + A504*dr) + (A024 + A124*dr + dr2*(A224 + A324*dr))*dtheta2 + (A044 + A144*dr)*dtheta4;
  A[3] = A006 + A106*dr + dr2*(A206 + A306*dr) + (A026 + A126*dr)*dtheta2;
  A[4] = A008 + A108*dr;

  /* r derivatives of coefficients */
  dA_dr[0] = 6*A600*dr5 + 7*A700*dr6 + 8*A800*dr7 + 9*A900*dr8 + 4*A420*dr3*dtheta2 + 5*A520*dr4*dtheta2 + 6*A620*dr5*dtheta2 + 7*A720*dr6*dtheta2 + 2*A240*dr*dtheta4 + 3*A340*dr2*dtheta4 + 4*A440*dr3*dtheta4 + 5*A540*dr4*dtheta4 + A160*dtheta6 + 2*A260*dr*dtheta6 + 3*A360*dr2*dtheta6 + A180*dtheta8;
  dA_dr[1] = 4*A402*dr3 + 5*A502*dr4 + 6*A602*dr5 + 7*A702*dr6 + 2*A222*dr*dtheta2 + 3*A322*dr2*dtheta2 + 4*A422*dr3*dtheta2 + 5*A522*dr4*dtheta2 + A142*dtheta4 + 2*A242*dr*dtheta4 + 3*A342*dr2*dtheta4 + A162*dtheta6;
  dA_dr[2] = 2*A204*dr + 3*A304*dr2 + 4*A404*dr3 + 5*A504*dr4 + A124*dtheta2 + 2*A224*dr*dtheta2 + 3*A324*dr2*dtheta2 + A144*dtheta4;
  dA_dr[3] = A106 + 2*A206*dr + 3*A306*dr2 + A126*dtheta2;
  dA_dr[4] = A108;

  /* r,r derivatives of coefficients */
  d2A_dr2[0] = 2*(15*A600*dr4 + 21*A700*dr5 + 28*A800*dr6 + 36*A900*dr7 + 6*A420*dr2*dtheta2 + 10*A520*dr3*dtheta2 + 15*A620*dr4*dtheta2 + 21*A720*dr5*dtheta2 + A240*dtheta4 + 3*A340*dr*dtheta4 + 6*A440*dr2*dtheta4 + 10*A540*dr3*dtheta4 + A260*dtheta6 + 3*A360*dr*dtheta6);
  d2A_dr2[1] = 2*(6*A402*dr2 + 10*A502*dr3 + 15*A602*dr4 + 21*A702*dr5 + A222*dtheta2 + 3*A322*dr*dtheta2 + 6*A422*dr2*dtheta2 + 10*A522*dr3*dtheta2 + A242*dtheta4 + 3*A342*dr*dtheta4);
  d2A_dr2[2] = 2*(A204 + 3*A304*dr + 6*A404*dr2 + 10*A504*dr3 + A224*dtheta2 + 3*A324*dr*dtheta2);
  d2A_dr2[3] = 2*(A206 + 3*A306*dr);
  d2A_dr2[4] = 0;

  /* theta derivatives of coefficients */
  dA_dtheta[0] = 2*(A420 + dr*(A520 + dr*(A620 + A720*dr)))*dr4*dtheta + 4*((A240 + A340*dr)*dr2 + (A440 + A540*dr)*dr4 + (A060 + dr*(A160 + dr*(A260 + A360*dr)))*dtheta2)*dtheta3 + 2*(A060 + dr*(A160 + dr*(A260 + A360*dr)))*dtheta5 + 8*(A080 + A180*dr)*dtheta7;
  dA_dtheta[1] = 2*dtheta*((A222 + A322*dr)*dr2 + (A422 + A522*dr)*dr4 + 2*dtheta2*(A042 + A142*dr + (A242 + A342*dr)*dr2 + (A062 + A162*dr)*dtheta2) + (A062 + A162*dr)*dtheta4);
  dA_dtheta[2] = 2*dtheta*(A024 + A124*dr + (A224 + A324*dr)*dr2 + 2*(A044 + A144*dr)*dtheta2);
  dA_dtheta[3] = 2*(A026 + A126*dr)*dtheta;
  dA_dtheta[4] = 0;

  /* theta,theta derivatives of coefficients */
  d2A_dtheta2[0] = 2*((A420 + dr*(A520 + dr*(A620 + A720*dr)))*dr4 + 6*dtheta2*((A240 + A340*dr)*dr2 + (A440 + A540*dr)*dr4 + (A060 + dr*(A160 + dr*(A260 + A360*dr)))*dtheta2) + 9*(A060 + dr*(A160 + dr*(A260 + A360*dr)))*dtheta4 + 28*(A080 + A180*dr)*dtheta6);
  d2A_dtheta2[1] = 2*((A222 + A322*dr)*dr2 + (A422 + A522*dr)*dr4 + 6*dtheta2*(A042 + A142*dr + (A242 + A342*dr)*dr2 + (A062 + A162*dr)*dtheta2) + 9*(A062 + A162*dr)*dtheta4);
  d2A_dtheta2[2] = 2*(A024 + A124*dr + (A224 + A324*dr)*dr2 + 6*(A044 + A144*dr)*dtheta2);
  d2A_dtheta2[3] = 2*(A026 + A126*dr);
  d2A_dtheta2[4] = 0;

  /* alpha term appearing in the denominator */
  alpha = alpha20*dr2 + alpha02*dtheta2;

  /* Derivatives of alpha */
  dalpha_dr       = 2*alpha20*dr;
  d2alpha_dr2     = 2*alpha20;
  dalpha_dtheta   = 2*alpha02*dtheta;
  d2alpha_dtheta2 = 2*alpha02;

  /* C term appearing in Elliptic integrals and related power series in numerator */
  const double C1 = alpha / beta;

  double C[17];
  C[0]  = 1;
  C[1]  = C1;
  C[2]  = C1*C1;
  C[3]  = C[2]*C[1];
  C[4]  = C[2]*C[2];
  C[5]  = C[3]*C[2];
  C[6]  = C[3]*C[3];
  C[7]  = C[4]*C[3];
  C[8]  = C[4]*C[4];
  C[9]  = C[5]*C[4];
  C[10] = C[5]*C[5];
  C[11] = C[6]*C[5];
  C[12] = C[6]*C[6];
  C[13] = C[7]*C[6];
  C[14] = C[7]*C[7];
  C[15] = C[8]*C[7];
  C[16] = C[8]*C[8];

  dC1_dr       = dalpha_dr / beta;
  d2C1_dr2     = d2alpha_dr2 / beta;
  dC1_dtheta   = dalpha_dtheta / beta;
  d2C1_dtheta2 = d2alpha_dtheta2 / beta;

  double dC_dr[17];
  dC_dr[0]  = 0;
  dC_dr[1]  = 1*C[0]*dC1_dr;
  dC_dr[2]  = 2*C[1]*dC1_dr;
  dC_dr[3]  = 3*C[2]*dC1_dr;
  dC_dr[4]  = 4*C[3]*dC1_dr;
  dC_dr[5]  = 5*C[4]*dC1_dr;
  dC_dr[6]  = 6*C[5]*dC1_dr;
  dC_dr[7]  = 7*C[6]*dC1_dr;
  dC_dr[8]  = 8*C[7]*dC1_dr;
  dC_dr[9]  = 9*C[8]*dC1_dr;
  dC_dr[10] = 10*C[9]*dC1_dr;
  dC_dr[11] = 11*C[10]*dC1_dr;
  dC_dr[12] = 12*C[11]*dC1_dr;
  dC_dr[13] = 13*C[12]*dC1_dr;
  dC_dr[14] = 14*C[13]*dC1_dr;
  dC_dr[15] = 15*C[14]*dC1_dr;
  dC_dr[16] = 16*C[15]*dC1_dr;

  double d2C_dr2[17];
  d2C_dr2[0]  = 0;
  d2C_dr2[1]  = d2C1_dr2;
  d2C_dr2[2]  = 2*1*C[0]*dC1_dr*dC1_dr + 2*C[1]*d2C1_dr2;
  d2C_dr2[3]  = 3*2*C[1]*dC1_dr*dC1_dr + 3*C[2]*d2C1_dr2;
  d2C_dr2[4]  = 4*3*C[2]*dC1_dr*dC1_dr + 4*C[3]*d2C1_dr2;
  d2C_dr2[5]  = 5*4*C[3]*dC1_dr*dC1_dr + 5*C[4]*d2C1_dr2;
  d2C_dr2[6]  = 6*5*C[4]*dC1_dr*dC1_dr + 6*C[5]*d2C1_dr2;
  d2C_dr2[7]  = 7*6*C[5]*dC1_dr*dC1_dr + 7*C[6]*d2C1_dr2;
  d2C_dr2[8]  = 8*7*C[6]*dC1_dr*dC1_dr + 8*C[7]*d2C1_dr2;
  d2C_dr2[9]  = 9*8*C[7]*dC1_dr*dC1_dr + 9*C[8]*d2C1_dr2;
  d2C_dr2[10] = 10*9*C[8]*dC1_dr*dC1_dr + 10*C[9]*d2C1_dr2;
  d2C_dr2[11] = 11*10*C[9]*dC1_dr*dC1_dr + 11*C[10]*d2C1_dr2;
  d2C_dr2[12] = 12*11*C[10]*dC1_dr*dC1_dr + 12*C[11]*d2C1_dr2;
  d2C_dr2[13] = 13*12*C[11]*dC1_dr*dC1_dr + 13*C[12]*d2C1_dr2;
  d2C_dr2[14] = 14*13*C[12]*dC1_dr*dC1_dr + 14*C[13]*d2C1_dr2;
  d2C_dr2[15] = 15*14*C[13]*dC1_dr*dC1_dr + 15*C[14]*d2C1_dr2;
  d2C_dr2[16] = 16*15*C[14]*dC1_dr*dC1_dr + 16*C[15]*d2C1_dr2;

  double dC_dtheta[17];
  dC_dtheta[0]  = 0;
  dC_dtheta[1]  = 1*C[0]*dC1_dtheta;
  dC_dtheta[2]  = 2*C[1]*dC1_dtheta;
  dC_dtheta[3]  = 3*C[2]*dC1_dtheta;
  dC_dtheta[4]  = 4*C[3]*dC1_dtheta;
  dC_dtheta[5]  = 5*C[4]*dC1_dtheta;
  dC_dtheta[6]  = 6*C[5]*dC1_dtheta;
  dC_dtheta[7]  = 7*C[6]*dC1_dtheta;
  dC_dtheta[8]  = 8*C[7]*dC1_dtheta;
  dC_dtheta[9]  = 9*C[8]*dC1_dtheta;
  dC_dtheta[10] = 10*C[9]*dC1_dtheta;
  dC_dtheta[11] = 11*C[10]*dC1_dtheta;
  dC_dtheta[12] = 12*C[11]*dC1_dtheta;
  dC_dtheta[13] = 13*C[12]*dC1_dtheta;
  dC_dtheta[14] = 14*C[13]*dC1_dtheta;
  dC_dtheta[15] = 15*C[14]*dC1_dtheta;
  dC_dtheta[16] = 16*C[15]*dC1_dtheta;

  double d2C_dtheta2[17];
  d2C_dtheta2[0]  = 0;
  d2C_dtheta2[1]  = d2C1_dtheta2;
  d2C_dtheta2[2]  = 2*1*C[0]*dC1_dtheta*dC1_dtheta + 2*C[1]*d2C1_dtheta2;
  d2C_dtheta2[3]  = 3*2*C[1]*dC1_dtheta*dC1_dtheta + 3*C[2]*d2C1_dtheta2;
  d2C_dtheta2[4]  = 4*3*C[2]*dC1_dtheta*dC1_dtheta + 4*C[3]*d2C1_dtheta2;
  d2C_dtheta2[5]  = 5*4*C[3]*dC1_dtheta*dC1_dtheta + 5*C[4]*d2C1_dtheta2;
  d2C_dtheta2[6]  = 6*5*C[4]*dC1_dtheta*dC1_dtheta + 6*C[5]*d2C1_dtheta2;
  d2C_dtheta2[7]  = 7*6*C[5]*dC1_dtheta*dC1_dtheta + 7*C[6]*d2C1_dtheta2;
  d2C_dtheta2[8]  = 8*7*C[6]*dC1_dtheta*dC1_dtheta + 8*C[7]*d2C1_dtheta2;
  d2C_dtheta2[9]  = 9*8*C[7]*dC1_dtheta*dC1_dtheta + 9*C[8]*d2C1_dtheta2;
  d2C_dtheta2[10] = 10*9*C[8]*dC1_dtheta*dC1_dtheta + 10*C[9]*d2C1_dtheta2;
  d2C_dtheta2[11] = 11*10*C[9]*dC1_dtheta*dC1_dtheta + 11*C[10]*d2C1_dtheta2;
  d2C_dtheta2[12] = 12*11*C[10]*dC1_dtheta*dC1_dtheta + 12*C[11]*d2C1_dtheta2;
  d2C_dtheta2[13] = 13*12*C[11]*dC1_dtheta*dC1_dtheta + 13*C[12]*d2C1_dtheta2;
  d2C_dtheta2[14] = 14*13*C[12]*dC1_dtheta*dC1_dtheta + 14*C[13]*d2C1_dtheta2;
  d2C_dtheta2[15] = 15*14*C[13]*dC1_dtheta*dC1_dtheta + 15*C[14]*d2C1_dtheta2;
  d2C_dtheta2[16] = 16*15*C[14]*dC1_dtheta*dC1_dtheta + 16*C[15]*d2C1_dtheta2;

  /* Elliptic integrals */
  ellE = gsl_sf_ellint_Ecomp(sqrt(1.0/(1.0+C1)), GSL_PREC_DOUBLE);
  ellK = gsl_sf_ellint_Kcomp(sqrt(1.0/(1.0+C1)), GSL_PREC_DOUBLE);
  const double ellip[2] = {ellK, ellE};

  /* Derivatives of elliptic integrals */
  dellE_dC   = (ellK - ellE)/(2.*(1+C1));
  dellK_dC   = (C1*ellK - (1+C1)*ellE)/(2.*C1*(1+C1));
  d2ellE_dC2 = -(2*C1*ellK - (2*C1-1)*ellE)/(4.*C1*(1+C1)*(1+C1));
  d2ellK_dC2 = -(C1*(1+2*C1)*ellK - 2*(1+C1)*(1+C1)*ellE)/(4.*C1*C1*(1+C1)*(1+C1));

  dellE_dr       = dellE_dC * dC1_dr;
  dellE_dtheta   = dellE_dC * dC1_dtheta;
  d2ellE_dr2     = d2ellE_dC2 * dC1_dr * dC1_dr + dellE_dC * d2C1_dr2;
  d2ellE_dtheta2 = d2ellE_dC2 * dC1_dtheta * dC1_dtheta + dellE_dC * d2C1_dtheta2;

  dellK_dr       = dellK_dC * dC1_dr;
  dellK_dtheta   = dellK_dC * dC1_dtheta;
  d2ellK_dr2     = d2ellK_dC2 * dC1_dr * dC1_dr + dellK_dC * d2C1_dr2;
  d2ellK_dtheta2 = d2ellK_dC2 * dC1_dtheta * dC1_dtheta + dellK_dC * d2C1_dtheta2;

  const double dellip_dr[2] = {dellK_dr, dellE_dr};
  const double dellip_dtheta[2] = {dellK_dtheta, dellE_dtheta};

  const double d2ellip_dr2[2] = {d2ellK_dr2, d2ellE_dr2};
  const double d2ellip_dtheta2[2] = {d2ellK_dtheta2, d2ellE_dtheta2};

  if(m>10)
  {
    printf("Support for computing mode %d has not yet been added.\n", m);
    return;
  }

  /* Numerator */
  double num = 0;
  for(int i=0; i<2; i++)
    for(int j=0; j<5; j++)
      for(int k=0; k<17; k++)
        num += EI[m][i][j][k]*ellip[i]*A[j]*C[k];
  double dnum_dr = 0;
  for(int i=0; i<2; i++)
    for(int j=0; j<5; j++)
      for(int k=0; k<17; k++)
        dnum_dr += EI[m][i][j][k]*
            (dellip_dr[i]*A[j]*C[k]
           + ellip[i]*dA_dr[j]*C[k]
           + ellip[i]*A[j]*dC_dr[k]);
  double d2num_dr2 = 0;
  for(int i=0; i<2; i++)
    for(int j=0; j<5; j++)
      for(int k=0; k<17; k++)
        d2num_dr2 += EI[m][i][j][k]*
            (d2ellip_dr2[i]*A[j]*C[k]
           + dellip_dr[i]*dA_dr[j]*C[k]
           + dellip_dr[i]*A[j]*dC_dr[k]
           + dellip_dr[i]*dA_dr[j]*C[k]
           + ellip[i]*d2A_dr2[j]*C[k]
           + ellip[i]*dA_dr[j]*dC_dr[k]
           + dellip_dr[i]*A[j]*dC_dr[k]
           + ellip[i]*dA_dr[j]*dC_dr[k]
           + ellip[i]*A[j]*d2C_dr2[k]);
  double dnum_dtheta = 0;
  for(int i=0; i<2; i++)
    for(int j=0; j<5; j++)
      for(int k=0; k<17; k++)
        dnum_dtheta += EI[m][i][j][k]*
            (dellip_dtheta[i]*A[j]*C[k]
           + ellip[i]*dA_dtheta[j]*C[k]
           + ellip[i]*A[j]*dC_dtheta[k]);
  double d2num_dtheta2 = 0;
  for(int i=0; i<2; i++)
    for(int j=0; j<5; j++)
      for(int k=0; k<17; k++)
        d2num_dtheta2 += EI[m][i][j][k]*
            (d2ellip_dtheta2[i]*A[j]*C[k]
           + dellip_dtheta[i]*dA_dtheta[j]*C[k]
           + dellip_dtheta[i]*A[j]*dC_dtheta[k]
           + dellip_dtheta[i]*dA_dtheta[j]*C[k]
           + ellip[i]*d2A_dtheta2[j]*C[k]
           + ellip[i]*dA_dtheta[j]*dC_dtheta[k]
           + dellip_dtheta[i]*A[j]*dC_dtheta[k]
           + ellip[i]*dA_dtheta[j]*dC_dtheta[k]
           + ellip[i]*A[j]*d2C_dtheta2[k]);

  /* Denominator */
  s        = beta*C[3]*pow(alpha+beta, 2.5);
  ds_dr    = beta*(3*C[2]*pow(alpha+beta, 2.5)*dC1_dr + C[3]*2.5*pow(alpha+beta, 1.5)*dalpha_dr);
  ds_dtheta   = beta*(3*C[2]*pow(alpha+beta, 2.5)*dC1_dtheta + C[3]*2.5*pow(alpha+beta, 1.5)*dalpha_dtheta);
  d2s_dr2  = beta*(6*C1*pow(alpha+beta, 2.5)*dC1_dr*dC1_dr
               + 3*C[2]*2.5*pow(alpha+beta, 1.5)*dalpha_dr*dC1_dr
               + 3*C[2]*pow(alpha+beta, 2.5)*d2C1_dr2
               + 3*C[2]*dC1_dr*2.5*pow(alpha+beta, 1.5)*dalpha_dr
               + C[3]*2.5*1.5*pow(alpha+beta, 0.5)*dalpha_dr*dalpha_dr
               + C[3]*2.5*pow(alpha+beta, 1.5)*d2alpha_dr2);
  d2s_dtheta2 = beta*(6*C1*pow(alpha+beta, 2.5)*dC1_dtheta*dC1_dtheta
               + 3*C[2]*2.5*pow(alpha+beta, 1.5)*dalpha_dtheta*dC1_dtheta
               + 3*C[2]*pow(alpha+beta, 2.5)*d2C1_dtheta2
               + 3*C[2]*dC1_dtheta*2.5*pow(alpha+beta, 1.5)*dalpha_dtheta
               + C[3]*2.5*1.5*pow(alpha+beta, 0.5)*dalpha_dtheta*dalpha_dtheta
               + C[3]*2.5*pow(alpha+beta, 1.5)*d2alpha_dtheta2);

  /* Singular field */
  double RePhiS = 4.0*num/s;

  /* First derivatives of PhiS */
  dPhiS_dt  = - m * om * (RePhiS); // This should be interpreted as pure-imaginary
  dPhiS_dr  = 4.0*(-ds_dr*num + dnum_dr*s) /(s*s);
  dPhiS_dth = 4.0*(-ds_dtheta*num + dnum_dtheta*s)/(s*s);
  dPhiS_dph = m * (RePhiS); // This should be interpreted as pure-imaginary

  /* Second derivatives of PhiS */
  d2PhiS_dr2   = 4.0*(2.0*ds_dr*ds_dr*num - s*(2*dnum_dr*ds_dr + d2s_dr2*num) + d2num_dr2*s*s)/(s*s*s);
  d2PhiS_dth2  = 4.0*(2.0*ds_dtheta*ds_dtheta*num - s*(2*dnum_dtheta*ds_dtheta + d2s_dtheta2*num) + d2num_dtheta2*s*s)/(s*s*s);
  d2PhiS_dph2  = - m*m*(RePhiS);
  d2PhiS_dt2   = - m*m*om*om*(RePhiS);
  d2PhiS_dtph = m*m*om*(RePhiS);

  /* Box[PhiS] */
  double sinth  = sin(theta);
  double sinth2 = sinth*sinth;
  double sin2th = sin(2*theta);
  double cos2th = cos(2*theta);
  double r2 = r*r;
  double r3 = r2*r;
  double r4 = r2*r2;
  double a2 = a*a;
  double a4 = a2*a2;

  double effsrc = -((2*a2*dPhiS_dr - a2*d2PhiS_dph2 - a4*d2PhiS_dr2 - a2*d2PhiS_dth2 - 4*dPhiS_dr*r - 2*a2*dPhiS_dr*r +
         4*d2PhiS_dph2*r + 2*a*d2PhiS_dtph*r + 4*a2*d2PhiS_dr2*r + 2*d2PhiS_dth2*r + 6*dPhiS_dr*r2 - 2*d2PhiS_dph2*r2 - 4*d2PhiS_dr2*r2 -
         2*a2*d2PhiS_dr2*r2 - d2PhiS_dth2*r2 - 2*dPhiS_dr*r3 + 4*d2PhiS_dr2*r3 - d2PhiS_dr2*r4 +
         (a4*d2PhiS_dt2 + 4*a*d2PhiS_dtph*r + 2*d2PhiS_dt2*r4 + a2*d2PhiS_dt2*r*(2 + 3*r))*sinth2 +
         cos2th*(a4*d2PhiS_dr2 - 2*a*d2PhiS_dtph*r + (-2 + r)*r*(d2PhiS_dth2 + 2*dPhiS_dr*(-1 + r) + d2PhiS_dr2*(-2 + r)*r) +
            a2*(-d2PhiS_dph2 + d2PhiS_dth2 + 2*dPhiS_dr*(-1 + r) - 4*d2PhiS_dr2*r + 2*d2PhiS_dr2*r2) +
            a2*d2PhiS_dt2*(a2 + (-2 + r)*r)*sinth2) - a2*dPhiS_dth*sin2th + 2*dPhiS_dth*r*sin2th -
         dPhiS_dth*r2*sin2th))/((sinth2*(a2 + (-2 + r)*r)*(a2 + 2*r2 + a2*cos2th)));

  /* Store calculated quantities into the arrays provided by the caller */
  PhiS[0] = RePhiS;
  PhiS[1] = 0;

  dPhiS_dx[0] = 0;
  dPhiS_dx[1] = dPhiS_dt;
  dPhiS_dx[2] = dPhiS_dr;
  dPhiS_dx[3] = 0;
  dPhiS_dx[4] = dPhiS_dth;
  dPhiS_dx[5] = 0;
  dPhiS_dx[6] = 0;
  dPhiS_dx[7] = dPhiS_dph;

  d2PhiS_dx2[0]  = d2PhiS_dt2;
  d2PhiS_dx2[1]  = 0;
  d2PhiS_dx2[2]  = d2PhiS_dtr;
  d2PhiS_dx2[3]  = 0;
  d2PhiS_dx2[4]  = d2PhiS_dtth;
  d2PhiS_dx2[5]  = 0;
  d2PhiS_dx2[6]  = d2PhiS_dtph;
  d2PhiS_dx2[7]  = 0;
  d2PhiS_dx2[8]  = d2PhiS_dr2;
  d2PhiS_dx2[9]  = 0;
  d2PhiS_dx2[10] = d2PhiS_drth;
  d2PhiS_dx2[11] = 0;
  d2PhiS_dx2[12] = d2PhiS_drph;
  d2PhiS_dx2[13] = 0;
  d2PhiS_dx2[14] = d2PhiS_dth2;
  d2PhiS_dx2[15] = 0;
  d2PhiS_dx2[16] = d2PhiS_dthph;
  d2PhiS_dx2[17] = 0;
  d2PhiS_dx2[18] = d2PhiS_dph2;
  d2PhiS_dx2[19] = 0;

  src[0] = effsrc;
  src[1] = 0;
}

/* Initialize array of coefficients of pows of dr, dtheta and dphi. */
void effsource_init(double mass, double spin)
{
  M = mass;
  a = spin;
}

/* Initialize array of coefficients of pows of dr, dtheta and dphi. */
void effsource_set_particle(struct coordinate * x_p, double E, double L, double ur_p)
{
  xp = *x_p;
  double r = xp.r;

  /* Compute A coefficients */
  {
	A006 = 64*pow(pow(L,2) + pow(r,2) + (pow(a,2)*(2*M + r))/r,3);
	A008 = (-32*pow(pow(a,2)*(2*M + r) + r*(pow(L,2) + pow(r,2)),2)*(-(pow(a,8)*pow(M,2)) + 4*pow(a,7)*E*L*pow(M,2) + 4*a*E*L*M*(2*M - 3*r)*pow(r,6) - 4*pow(a,3)*E*L*M*pow(r,3)*(22*pow(M,2) + 3*M*r + 4*pow(r,2)) - 4*pow(a,5)*E*L*M*(16*pow(M,3) + 18*pow(M,2)*r + pow(r,3)) + pow(r,6)*(2*M*pow(r,2)*(-2*M + r + 2*pow(E,2)*r) + pow(L,2)*(-16*pow(M,2) + 14*M*r - 3*pow(r,2))) + 2*pow(a,6)*M*(-2*pow(L,2)*M + 2*pow(E,2)*pow(2*M + r,3) + r*(2*pow(M,2) - M*r + pow(r,2))) + pow(a,2)*pow(r,3)*(2*M*pow(r,2)*(4*pow(M,2) + 6*(-1 + 2*pow(E,2))*M*r + 3*(1 + 2*pow(E,2))*pow(r,2)) + pow(L,2)*(32*pow(M,3) - 24*pow(M,2)*r + 16*M*pow(r,2) - 3*pow(r,3))) + pow(a,4)*M*(4*pow(L,2)*(8*pow(M,3) + 6*pow(M,2)*r - 3*M*pow(r,2) + 2*pow(r,3)) + pow(r,2)*(-4*pow(M,3) + 3*(-3 + 16*pow(E,2))*M*pow(r,2) + 6*(1 + 2*pow(E,2))*pow(r,3) + 4*pow(M,2)*(r + 12*pow(E,2)*r)))))/(3.*pow(r,8)*(pow(a,2) + r*(-2*M + r)));
	A024 = 48*pow(pow(a,2)*(2*M + r) + r*(pow(L,2) + pow(r,2)),2);
	A026 = (-16*(pow(a,2)*(2*M + r) + r*(pow(L,2) + pow(r,2)))*(-2*pow(a,7)*E*L*M*(24*pow(M,2) + 16*M*r + 3*pow(r,2)) + 2*a*E*L*M*pow(r,5)*(pow(L,2)*(10*M - 9*r) + (14*M - 15*r)*pow(r,2)) - 2*pow(a,5)*E*L*M*r*(16*pow(M,3) + 56*pow(M,2)*r + 50*M*pow(r,2) + 17*pow(r,3) + 3*pow(L,2)*(4*M + r)) + pow(a,8)*M*(6*pow(E,2)*pow(2*M + r,2) - r*(7*M + 3*r)) + pow(r,5)*(2*pow(L,2)*pow(r,2)*(-18*pow(M,2) + (21 + 2*pow(E,2))*M*r - 6*pow(r,2)) + pow(r,4)*(-8*pow(M,2) + 2*(5 + 4*pow(E,2))*M*r - 3*pow(r,2)) - 2*pow(L,4)*(8*pow(M,2) - 10*M*r + 3*pow(r,2))) + 2*pow(a,3)*E*L*M*pow(r,2)*(2*pow(L,2)*(4*pow(M,2) - 7*M*r - 6*pow(r,2)) - pow(r,2)*(16*pow(M,2) + 28*M*r + 29*pow(r,2))) + pow(a,4)*r*(12*pow(L,4)*pow(M,2) + pow(L,2)*(16*pow(M,4) - 8*(-5 + pow(E,2))*pow(M,3)*r + 16*(2 + pow(E,2))*pow(M,2)*pow(r,2) + 2*(-3 + 8*pow(E,2))*M*pow(r,3) - 9*pow(r,4)) + pow(r,2)*(4*pow(M,4) + 16*(2 + 3*pow(E,2))*pow(M,3)*r + 3*(3 + 32*pow(E,2))*pow(M,2)*pow(r,2) + 3*(-5 + 14*pow(E,2))*M*pow(r,3) - 9*pow(r,4))) + pow(a,2)*pow(r,2)*(pow(L,2)*pow(r,2)*(-4*pow(M,3) + 4*(6 + pow(E,2))*pow(M,2)*r + (33 + 14*pow(E,2))*M*pow(r,2) - 21*pow(r,3)) + pow(L,4)*(-8*pow(M,3) + 12*pow(M,2)*r + 8*M*pow(r,2) - 6*pow(r,3)) + pow(r,4)*(4*pow(M,3) + 3*(3 + 10*pow(E,2))*M*pow(r,2) - 9*pow(r,3) + 12*pow(M,2)*(r + 3*pow(E,2)*r))) + pow(a,6)*(pow(L,2)*M*(24*pow(M,2) + 4*(2 + 3*pow(E,2))*M*r + 3*(-1 + 2*pow(E,2))*pow(r,2)) + r*(-(r*(-12*pow(M,3) + 18*pow(M,2)*r + 17*M*pow(r,2) + 3*pow(r,3))) + 2*pow(E,2)*M*(8*pow(M,3) + 36*pow(M,2)*r + 42*M*pow(r,2) + 13*pow(r,3))))))/(3.*pow(r,6)*(pow(a,2) + r*(-2*M + r)));
	A042 = 12*pow(r,3)*(pow(a,2)*(2*M + r) + r*(pow(L,2) + pow(r,2)));
	A044 = (-2*(-4*pow(a,7)*E*L*M*(72*pow(M,2) + 59*M*r + 12*pow(r,2)) + 4*a*E*L*M*pow(r,3)*(pow(L,4)*(8*M - 6*r) + 6*pow(L,2)*(6*M - 5*r)*pow(r,2) + 3*(10*M - 9*r)*pow(r,4)) + pow(a,8)*(-13*pow(M,2)*r + 3*pow(r,3) + 36*pow(E,2)*M*pow(2*M + r,2)) - 4*pow(a,5)*E*L*M*r*(-48*pow(M,3) + 50*pow(M,2)*r + 140*M*pow(r,2) + 49*pow(r,3) + 6*pow(L,2)*(8*M + 3*r)) + pow(r,3)*(8*pow(L,6)*M*(-2*M + r) + pow(L,2)*pow(r,4)*(-120*pow(M,2) + 2*(71 + 12*pow(E,2))*M*r - 41*pow(r,2)) + pow(L,4)*pow(r,2)*(-100*pow(M,2) + 4*(25 + pow(E,2))*M*r - 25*pow(r,2)) + pow(r,6)*(-24*pow(M,2) + 2*(19 + 12*pow(E,2))*M*r - 13*pow(r,2))) - 4*pow(a,3)*E*L*M*pow(r,2)*(6*pow(L,4) + pow(L,2)*(-48*pow(M,2) + 36*M*r + 48*pow(r,2)) + pow(r,2)*(-66*pow(M,2) + 55*M*r + 64*pow(r,2))) + pow(a,2)*pow(r,2)*(12*pow(L,6)*M + pow(L,2)*pow(r,2)*(-192*pow(M,3) + 176*pow(M,2)*r + 12*(9 + 8*pow(E,2))*M*pow(r,2) - 73*pow(r,3)) + 2*pow(r,4)*(-12*pow(M,3) + 2*(23 + 18*pow(E,2))*pow(M,2)*r + 9*(1 + 6*pow(E,2))*M*pow(r,2) - 18*pow(r,3)) - 2*pow(L,4)*(48*pow(M,3) + 8*(-3 + pow(E,2))*pow(M,2)*r - 2*(17 + 4*pow(E,2))*M*pow(r,2) + 11*pow(r,3))) + pow(a,4)*r*(3*pow(L,4)*(32*pow(M,2) + 4*(2 + pow(E,2))*M*r + pow(r,2)) + pow(r,2)*(12*pow(M,4) + 116*pow(M,3)*r + (55 + 288*pow(E,2))*pow(M,2)*pow(r,2) + 6*(-13 + 30*pow(E,2))*M*pow(r,3) - 30*pow(r,4)) - 2*pow(L,2)*(48*pow(M,4) + 4*(-7 + 12*pow(E,2))*pow(M,3)*r - 2*(53 + 24*pow(E,2))*pow(M,2)*pow(r,2) + 4*(2 - 15*pow(E,2))*M*pow(r,3) + 13*pow(r,4))) + 2*pow(a,6)*(pow(L,2)*(72*pow(M,3) + 2*(23 + 24*pow(E,2))*pow(M,2)*r + 6*(1 + 4*pow(E,2))*M*pow(r,2) + 3*pow(r,3)) + r*(-(r*(-10*pow(M,3) + 37*pow(M,2)*r + 29*M*pow(r,2) + 2*pow(r,3))) + 6*pow(E,2)*M*(-8*pow(M,3) + 12*pow(M,2)*r + 30*M*pow(r,2) + 11*pow(r,3))))))/(3.*pow(r,3)*(pow(a,2) + r*(-2*M + r)));
	A060 = pow(r,6);
	A062 = (6*pow(a,5)*E*L*M*(12*M + 5*r) + 4*pow(a,3)*E*L*M*r*(6*pow(L,2) - 20*pow(M,2) + 11*M*r + 18*pow(r,2)) - 3*pow(a,6)*(r*(M + r) + 6*pow(E,2)*M*(2*M + r)) + 2*a*E*L*M*pow(r,2)*(-4*pow(L,2)*(4*M - 3*r) + pow(r,2)*(-26*M + 21*r)) + pow(r,2)*(8*pow(L,4)*M*(2*M - r) + 4*pow(r,4)*(2*pow(M,2) - (3 + 2*pow(E,2))*M*r + pow(r,2)) + pow(L,2)*pow(r,2)*(36*pow(M,2) - 4*(8 + pow(E,2))*M*r + 7*pow(r,2))) + pow(a,2)*r*(-12*pow(L,4)*M + 4*pow(L,2)*(10*pow(M,3) + (-3 + 4*pow(E,2))*pow(M,2)*r - 2*(3 + 2*pow(E,2))*M*pow(r,2) + pow(r,3)) + pow(r,2)*(4*pow(M,3) + 4*(-4 + pow(E,2))*pow(M,2)*r + (1 - 34*pow(E,2))*M*pow(r,2) + 5*pow(r,3))) - pow(a,4)*(3*pow(L,2)*(12*pow(M,2) + 4*(1 + pow(E,2))*M*r + pow(r,2)) + 2*r*(r*(-2*pow(M,2) - 5*M*r + pow(r,2)) + 2*pow(E,2)*M*(-10*pow(M,2) + 8*M*r + 11*pow(r,2)))))/(3.*(pow(a,2) + r*(-2*M + r)));
	A080 = (pow(r,3)*(r*(-3*pow(a,2) + r*(-2*M + r)) + (4*M*(-3*pow(a,4)*pow(E,2) + 6*pow(a,3)*E*L + 2*a*E*L*r*(-4*M + 3*r) + pow(a,2)*(-3*pow(L,2) + 4*pow(E,2)*(M - r)*r) - r*(pow(E,2)*pow(r,3) + pow(L,2)*(-4*M + 2*r))))/(pow(a,2) + r*(-2*M + r))))/24.;
	A106 = (-16*pow(pow(L,2) + pow(r,2) + (pow(a,2)*(2*M + r))/r,2)*(-2*pow(a,2)*M + 2*pow(r,3) + (4*L*(pow(a,3)*E*M - pow(a,2)*L*M + 3*a*E*M*pow(r,2) + L*pow(r,2)*(-2*M + r)))/(pow(a,2) + r*(-2*M + r))))/pow(r,2);
	A108 = (-16*(pow(a,2)*(2*M + r) + r*(pow(L,2) + pow(r,2)))*(2*pow(a,11)*E*L*pow(M,2)*(80*pow(M,2) + 73*M*r + 12*pow(r,2)) + 2*pow(a,9)*E*L*M*r*(32*(-1 + 6*pow(E,2))*pow(M,4) + 12*(23 + 24*pow(E,2))*pow(M,3)*r + (353 + 144*pow(E,2))*pow(M,2)*pow(r,2) + 2*(11 + 12*pow(E,2))*M*pow(r,3) - 12*pow(r,4) + 4*pow(L,2)*M*(16*M + 3*r)) + pow(a,12)*pow(M,2)*(3*r*(3*M + 2*r) - 8*pow(E,2)*(10*pow(M,2) + 11*M*r + 3*pow(r,2))) + 2*a*E*L*M*pow(r,5)*(6*pow(L,4)*pow(r,2)*(20*pow(M,2) + 4*pow(E,2)*M*r - 5*pow(r,2)) + 12*pow(L,6)*(4*pow(M,2) - pow(r,2)) + pow(L,2)*pow(r,4)*(136*pow(M,2) + 2*(-37 + 30*pow(E,2))*M*r + 3*pow(r,2)) - 2*pow(r,6)*(34*pow(M,2) - 41*M*r + 12*pow(r,2))) + 4*pow(a,3)*E*L*M*pow(r,3)*(6*pow(L,6)*(12*pow(M,2) - 2*M*r - pow(r,2)) + pow(L,2)*pow(r,3)*(-340*pow(M,3) + 6*(61 + 20*pow(E,2))*pow(M,2)*r + (-83 + 90*pow(E,2))*M*pow(r,2) - 23*pow(r,3)) + 2*pow(r,5)*(-192*pow(M,3) + 81*pow(M,2)*r + 6*(7 + pow(E,2))*M*pow(r,2) - 19*pow(r,3)) + 6*pow(L,4)*r*(20*pow(M,3) + 4*(10 + pow(E,2))*pow(M,2)*r + 2*(-5 + 2*pow(E,2))*M*pow(r,2) - 5*pow(r,3))) + 2*pow(a,5)*E*L*M*pow(r,2)*(6*pow(L,4)*(2*M + r)*(60*pow(M,2) + 2*(-5 + 2*pow(E,2))*M*r - 5*pow(r,2)) + pow(r,3)*(-420*pow(M,4) - 876*pow(M,3)*r + (907 + 144*pow(E,2))*pow(M,2)*pow(r,2) + 24*(5 + 3*pow(E,2))*M*pow(r,3) - 92*pow(r,4)) + pow(L,2)*r*(-608*pow(M,4) + 8*(13 + 30*pow(E,2))*pow(M,3)*r + 48*(17 + 10*pow(E,2))*pow(M,2)*pow(r,2) + 36*(-7 + 5*pow(E,2))*M*pow(r,3) - 79*pow(r,4))) + pow(a,2)*pow(r,3)*(48*pow(L,8)*pow(M,2)*(-2*M + r) - 24*pow(L,6)*M*pow(r,2)*(2*(5 + 4*pow(E,2))*pow(M,2) + (-5 + 4*pow(E,2))*M*r - 2*pow(E,2)*pow(r,2)) + 2*M*pow(r,7)*(60*pow(M,3) + 4*(-22 + 25*pow(E,2))*pow(M,2)*r + (51 - 86*pow(E,2))*M*pow(r,2) + (-11 + 23*pow(E,2))*pow(r,3)) + pow(L,2)*pow(r,5)*(752*pow(M,4) - 4*(197 + 66*pow(E,2))*pow(M,3)*r + 8*(28 - 11*pow(E,2))*pow(M,2)*pow(r,2) + 3*(1 + 48*pow(E,2))*M*pow(r,3) - 6*pow(r,4)) + 2*pow(L,4)*pow(r,3)*(232*pow(M,4) - 36*(9 + 10*pow(E,2))*pow(M,3)*r - 2*(-71 + 60*pow(E,2))*pow(M,2)*pow(r,2) + 5*(-5 + 18*pow(E,2))*M*pow(r,3) + 3*pow(r,4))) + 2*pow(a,7)*E*L*M*r*(2*pow(L,2)*(288*pow(M,4) + 8*(29 + 15*pow(E,2))*pow(M,3)*r + 2*(71 + 60*pow(E,2))*pow(M,2)*pow(r,2) + 2*(-26 + 15*pow(E,2))*M*pow(r,3) - 15*pow(r,4)) + r*(-256*pow(M,5) - 556*pow(M,4)*r + 8*(-7 + 36*pow(E,2))*pow(M,3)*pow(r,2) + (827 + 288*pow(E,2))*pow(M,2)*pow(r,3) + 4*(11 + 18*pow(E,2))*M*pow(r,4) - 52*pow(r,5))) - pow(a,4)*pow(r,2)*(24*pow(L,6)*M*(20*pow(M,3) + 12*pow(E,2)*pow(M,2)*r + (-5 + 2*pow(E,2))*M*pow(r,2) - pow(E,2)*pow(r,3)) + 2*pow(L,4)*M*r*(-304*pow(M,4) + 8*(11 + 60*pow(E,2))*pow(M,3)*r + 60*(5 + 14*pow(E,2))*pow(M,2)*pow(r,2) + 60*(-3 + pow(E,2))*M*pow(r,3) + (11 - 90*pow(E,2))*pow(r,4)) + M*pow(r,5)*(48*pow(M,4) - 4*(31 + 168*pow(E,2))*pow(M,3)*r - 8*(-34 + 21*pow(E,2))*pow(M,2)*pow(r,2) + (-199 + 448*pow(E,2))*M*pow(r,3) + 12*(4 - 7*pow(E,2))*pow(r,4)) + pow(L,2)*pow(r,3)*(-296*pow(M,5) - 16*(50 + 57*pow(E,2))*pow(M,4)*r + 2*(627 + 452*pow(E,2))*pow(M,3)*pow(r,2) + 2*(-215 + 12*pow(E,2))*pow(M,2)*pow(r,3) - 6*(-3 + 38*pow(E,2))*M*pow(r,4) + 3*pow(r,5))) + pow(a,6)*M*r*(-4*pow(L,4)*(96*pow(M,4) + 4*(11 + 90*pow(E,2))*pow(M,3)*r + 16*(2 + 15*pow(E,2))*pow(M,2)*pow(r,2) - 38*M*pow(r,3) - 15*pow(E,2)*pow(r,4)) + pow(r,3)*(-56*pow(M,5) + 4*(9 + 128*pow(E,2))*pow(M,4)*r + 2*(41 + 520*pow(E,2))*pow(M,3)*pow(r,2) - (157 + 464*pow(E,2))*pow(M,2)*pow(r,3) + (163 - 568*pow(E,2))*M*pow(r,4) + 4*(-13 + 19*pow(E,2))*pow(r,5)) + pow(L,2)*r*(256*pow(M,5) + 8*(47 + 76*pow(E,2))*pow(M,4)*r - 8*(-3 + 76*pow(E,2))*pow(M,3)*pow(r,2) - 2*(415 + 716*pow(E,2))*pow(M,2)*pow(r,3) + 2*(143 - 8*pow(E,2))*M*pow(r,4) + (-17 + 160*pow(E,2))*pow(r,5))) - (2*M - r)*pow(r,8)*(2*pow(E,2)*M*(12*pow(L,6) + 30*pow(L,4)*pow(r,2) + 17*pow(L,2)*pow(r,4) + 5*pow(r,6)) + (2*M - r)*r*(2*pow(L,4)*(8*M - 3*r) + 4*M*pow(r,4) + pow(L,2)*pow(r,2)*(2*M + 3*r))) - pow(a,10)*M*(2*pow(L,2)*M*(40*pow(M,2) + (29 + 32*pow(E,2))*M*r + 3*(-1 + 4*pow(E,2))*pow(r,2)) + r*(r*(50*pow(M,3) + 11*pow(M,2)*r - 19*M*pow(r,2) + 6*pow(r,3)) + pow(E,2)*(-32*pow(M,4) + 336*pow(M,3)*r + 504*pow(M,2)*pow(r,2) + 156*M*pow(r,3) - 6*pow(r,4)))) - pow(a,8)*M*r*(64*pow(L,4)*pow(M,2) + 2*pow(L,2)*(16*(-1 + 36*pow(E,2))*pow(M,4) + 4*(27 + 166*pow(E,2))*pow(M,3)*r + (141 + 364*pow(E,2))*pow(M,2)*pow(r,2) + 3*(-13 + 6*pow(E,2))*M*pow(r,3) + 3*(1 - 7*pow(E,2))*pow(r,4)) + r*(r*(-92*pow(M,4) + 20*pow(M,3)*r + 65*pow(M,2)*pow(r,2) - 63*M*pow(r,3) + 28*pow(r,4)) - 2*pow(E,2)*(128*pow(M,5) + 368*pow(M,4)*r + 120*pow(M,3)*pow(r,2) - 424*pow(M,2)*pow(r,3) - 202*M*pow(r,4) + 17*pow(r,5))))))/(3.*pow(r,10)*pow(pow(a,2) + r*(-2*M + r),2));
	A124 = 8*(pow(L,2) + pow(r,2) + (pow(a,2)*(2*M + r))/r)*(-(pow(a,2)*r) - pow(L,2)*r - 3*pow(r,3) - (4*L*(pow(a,3)*E*M - pow(a,2)*L*M + 3*a*E*M*pow(r,2) + L*pow(r,2)*(-2*M + r)))/(pow(a,2) + r*(-2*M + r)));
	A126 = (-4*(2*pow(a,11)*E*L*pow(M,2)*(-16*(-16 + 9*pow(E,2))*pow(M,2) + (293 - 144*pow(E,2))*M*r + 6*(13 - 6*pow(E,2))*pow(r,2)) + 2*a*E*L*M*pow(r,5)*(2*pow(L,4)*pow(r,2)*(328*pow(M,2) + 2*(-79 + 21*pow(E,2))*M*r - 3*pow(r,2)) + 42*pow(L,6)*(4*pow(M,2) - pow(r,2)) + 3*pow(L,2)*pow(r,4)*(128*pow(M,2) + 2*(-37 + 20*pow(E,2))*M*r + 5*pow(r,2)) - 2*pow(r,6)*(118*pow(M,2) - 125*M*r + 33*pow(r,2))) - (2*M - r)*pow(r,7)*(2*pow(r,6)*(16*pow(M,2) + 2*(-7 + 10*pow(E,2))*M*r + 3*pow(r,2)) + 4*pow(L,6)*(16*pow(M,2) + (-20 + 21*pow(E,2))*M*r + 6*pow(r,2)) + 2*pow(L,2)*pow(r,4)*(10*pow(M,2) + (-17 + 66*pow(E,2))*M*r + 6*pow(r,2)) + pow(L,4)*pow(r,2)*(88*pow(M,2) + 2*(-61 + 94*pow(E,2))*M*r + 39*pow(r,2))) + pow(a,12)*M*(3*r*(21*pow(M,2) + 23*M*r + 6*pow(r,2)) - 2*pow(E,2)*(128*pow(M,3) + 172*pow(M,2)*r + 72*M*pow(r,2) + 9*pow(r,3))) + 4*pow(a,3)*E*L*M*pow(r,3)*(21*pow(L,6)*(12*pow(M,2) - 2*M*r - pow(r,2)) + pow(r,5)*(-1104*pow(M,3) + 4*(82 + 27*pow(E,2))*pow(M,2)*r + (311 - 18*pow(E,2))*M*pow(r,2) - 103*pow(r,3)) + 2*pow(L,4)*r*(256*pow(M,3) + 2*(127 + 21*pow(E,2))*pow(M,2)*r + 6*(-24 + 7*pow(E,2))*M*pow(r,2) - 21*pow(r,3)) - 2*pow(L,2)*pow(r,3)*(102*pow(M,3) - 2*(92 + 87*pow(E,2))*pow(M,2)*r + 5*(17 - 15*pow(E,2))*M*pow(r,2) + 11*pow(r,3))) + 2*pow(a,5)*E*L*M*pow(r,2)*(2*pow(L,4)*(1224*pow(M,3) + 28*(-1 + 3*pow(E,2))*pow(M,2)*r + 2*(-95 + 21*pow(E,2))*M*pow(r,2) - 39*pow(r,3)) + pow(r,3)*(-3300*pow(M,4) + 4*(-517 + 216*pow(E,2))*pow(M,3)*r + (2435 + 504*pow(E,2))*pow(M,2)*pow(r,2) + 12*(59 - 12*pow(E,2))*M*pow(r,3) - 250*pow(r,4)) + pow(L,2)*r*(-192*pow(M,4) + 8*(169 + 114*pow(E,2))*pow(M,3)*r + 72*(4 + 17*pow(E,2))*pow(M,2)*pow(r,2) + 2*(-131 + 102*pow(E,2))*M*pow(r,3) - 131*pow(r,4))) - 2*pow(a,9)*E*L*M*(2*pow(L,2)*M*(216*pow(M,2) + 4*(2 + 9*pow(E,2))*M*r + 3*(-17 + 6*pow(E,2))*pow(r,2)) + r*(-288*(1 + 3*pow(E,2))*pow(M,4) - 4*(275 + 144*pow(E,2))*pow(M,3)*r + 3*(-403 + 72*pow(E,2))*pow(M,2)*pow(r,2) + 6*(-43 + 24*pow(E,2))*M*pow(r,3) + 36*pow(r,4))) + pow(a,2)*pow(r,3)*(-168*pow(L,8)*pow(M,2)*(2*M - r) - 2*pow(L,6)*r*(56*pow(M,4) + 12*(23 + 28*pow(E,2))*pow(M,3)*r + 14*(-13 + 12*pow(E,2))*pow(M,2)*pow(r,2) + 3*(13 - 28*pow(E,2))*M*pow(r,3) - 12*pow(r,4)) + 2*pow(r,7)*(132*pow(M,4) + 4*(-39 + 64*pow(E,2))*pow(M,3)*r + (113 - 246*pow(E,2))*pow(M,2)*pow(r,2) + (-58 + 79*pow(E,2))*M*pow(r,3) + 12*pow(r,4)) + 2*pow(L,4)*pow(r,3)*(592*pow(M,4) - 4*(139 + 329*pow(E,2))*pow(M,3)*r + 2*(91 - 22*pow(E,2))*pow(M,2)*pow(r,2) + 5*(-22 + 53*pow(E,2))*M*pow(r,3) + 42*pow(r,4)) + pow(L,2)*pow(r,5)*(2112*pow(M,4) - 4*(419 + 324*pow(E,2))*pow(M,3)*r - 4*(-73 + 4*pow(E,2))*pow(M,2)*pow(r,2) + (-93 + 464*pow(E,2))*M*pow(r,3) + 51*pow(r,4))) + 2*pow(a,7)*E*L*M*r*(-24*pow(L,4)*M*(9*M - r) + 2*pow(L,2)*(1296*pow(M,4) + 8*(35 + 51*pow(E,2))*pow(M,3)*r + 4*(-52 + 57*pow(E,2))*pow(M,2)*pow(r,2) - (19 + 6*pow(E,2))*M*pow(r,3) - 36*pow(r,4)) + r*(-1600*pow(M,5) + 4*(-515 + 216*pow(E,2))*pow(M,4)*r + 72*(13 + 22*pow(E,2))*pow(M,3)*pow(r,2) + 3*(857 + 72*pow(E,2))*pow(M,2)*pow(r,3) + 12*(43 - 18*pow(E,2))*M*pow(r,4) - 146*pow(r,5))) + pow(a,4)*pow(r,2)*(-4*pow(L,6)*M*(408*pow(M,3) + 4*(-32 + 63*pow(E,2))*pow(M,2)*r + 2*(-26 + 21*pow(E,2))*M*pow(r,2) - (5 + 21*pow(E,2))*pow(r,3)) + 2*pow(r,5)*(192*pow(M,5) + 24*(-1 + 53*pow(E,2))*pow(M,4)*r + 12*(-18 + 11*pow(E,2))*pow(M,3)*pow(r,2) + 4*(27 - 152*pow(E,2))*pow(M,2)*pow(r,3) + (-47 + 107*pow(E,2))*M*pow(r,4) + 18*pow(r,5)) + pow(L,4)*r*(1056*pow(M,5) - 80*(12 + 47*pow(E,2))*pow(M,4)*r - 8*(60 + 491*pow(E,2))*pow(M,3)*pow(r,2) + 12*(12 + 65*pow(E,2))*pow(M,2)*pow(r,3) + 2*(38 + 239*pow(E,2))*M*pow(r,4) + 45*pow(r,5)) + pow(L,2)*pow(r,3)*(3096*pow(M,5) + 12*(55 - 192*pow(E,2))*pow(M,4)*r - 2*(1367 + 788*pow(E,2))*pow(M,3)*pow(r,2) + (275 + 1116*pow(E,2))*pow(M,2)*pow(r,3) + 6*(21 + 94*pow(E,2))*M*pow(r,4) + 66*pow(r,5))) + pow(a,6)*r*(6*pow(L,6)*M*(24*pow(M,2) - 10*M*r + 3*pow(r,2)) - 2*pow(L,4)*M*(864*pow(M,4) + 8*(-1 + 306*pow(E,2))*pow(M,3)*r + 4*(-29 + 164*pow(E,2))*pow(M,2)*pow(r,2) - 32*(-2 + 9*pow(E,2))*M*pow(r,3) - (69 + 59*pow(E,2))*pow(r,4)) + pow(r,3)*(-152*pow(M,6) + 4*(23 + 800*pow(E,2))*pow(M,5)*r + 2*(-31 + 1672*pow(E,2))*pow(M,4)*pow(r,2) - (331 + 1792*pow(E,2))*pow(M,3)*pow(r,3) + (109 - 1704*pow(E,2))*pow(M,2)*pow(r,4) + 4*(8 + 19*pow(E,2))*M*pow(r,5) + 24*pow(r,6)) + pow(L,2)*r*(1600*pow(M,6) - 8*(-167 + 300*pow(E,2))*pow(M,5)*r - 4*(243 + 1228*pow(E,2))*pow(M,4)*pow(r,2) + 6*(-333 + 40*pow(E,2))*pow(M,3)*pow(r,3) + (59 + 1196*pow(E,2))*pow(M,2)*pow(r,4) + (293 + 228*pow(E,2))*M*pow(r,5) + 27*pow(r,6))) - pow(a,10)*M*(pow(L,2)*(-32*(-8 + 27*pow(E,2))*pow(M,3) + (242 - 448*pow(E,2))*pow(M,2)*r + 3*(-19 + 20*pow(E,2))*M*pow(r,2) + 18*(-3 + 2*pow(E,2))*pow(r,3)) + r*(r*(290*pow(M,3) + 165*pow(M,2)*r - 141*M*pow(r,2) - 68*pow(r,3)) + 2*pow(E,2)*(144*pow(M,4) + 680*pow(M,3)*r + 864*pow(M,2)*pow(r,2) + 358*M*pow(r,3) + 37*pow(r,4)))) + pow(a,8)*(2*pow(L,4)*M*(144*pow(M,3) + 8*(-8 + 27*pow(E,2))*pow(M,2)*r + 6*(-6 + 7*pow(E,2))*M*pow(r,2) - 9*(-3 + pow(E,2))*pow(r,3)) - pow(L,2)*M*r*(288*(1 + 18*pow(E,2))*pow(M,4) + 8*(105 + 286*pow(E,2))*pow(M,3)*r - 2*(-589 + 516*pow(E,2))*pow(M,2)*pow(r,2) + (15 - 268*pow(E,2))*M*pow(r,3) + 2*(-93 + 20*pow(E,2))*pow(r,4)) + pow(r,2)*(4*pow(E,2)*M*(400*pow(M,5) + 696*pow(M,4)*r - 12*pow(M,3)*pow(r,2) - 732*pow(M,2)*pow(r,3) - 368*M*pow(r,4) - 19*pow(r,5)) + r*(404*pow(M,5) + 8*pow(M,4)*r - 375*pow(M,3)*pow(r,2) + 103*pow(M,2)*pow(r,3) + 100*M*pow(r,4) + 6*pow(r,5))))))/(3.*pow(r,7)*pow(pow(a,2) + r*(-2*M + r),2));
	A142 = pow(r,2)*(2*pow(a,2)*M - 2*pow(r,3) - (4*L*(pow(a,3)*E*M - pow(a,2)*L*M + 3*a*E*M*pow(r,2) + L*pow(r,2)*(-2*M + r)))/(pow(a,2) + r*(-2*M + r)) - 4*(pow(a,2)*(2*M + r) + r*(pow(L,2) + pow(r,2))));
	A144 = (2*pow(a,9)*E*L*M*(16*(-16 + 9*pow(E,2))*pow(M,2) + 12*(-13 + 6*pow(E,2))*M*r - 3*pow(r,2)) + (2*M - r)*pow(r,4)*(16*pow(L,6)*M*(2*M - r) + 2*pow(L,2)*pow(r,4)*(-6*pow(M,2) + (-5 + 66*pow(E,2))*M*r + 4*pow(r,2)) + 2*pow(L,4)*pow(r,2)*(34*pow(M,2) + (-33 + 47*pow(E,2))*M*r + 8*pow(r,2)) + pow(r,6)*(48*pow(M,2) + 10*(-5 + 6*pow(E,2))*M*r + 13*pow(r,2))) - 2*a*E*L*M*pow(r,4)*(2*pow(L,4)*(200*pow(M,2) - 94*M*r - 3*pow(r,2)) + 3*pow(L,2)*pow(r,2)*(188*pow(M,2) + 4*(-27 + 5*pow(E,2))*M*r + 7*pow(r,2)) - 3*pow(r,4)*(100*pow(M,2) - 116*M*r + 33*pow(r,2))) + pow(a,10)*M*(-9*r*(13*M + 7*r) + pow(E,2)*(256*pow(M,2) + 264*M*r + 66*pow(r,2))) - 2*pow(a,3)*E*L*M*pow(r,2)*(4*pow(L,4)*(180*pow(M,2) - 92*M*r - 3*pow(r,2)) + pow(L,2)*r*(768*pow(M,3) + 4*(67 + 84*pow(E,2))*pow(M,2)*r + 4*(-149 + 9*pow(E,2))*M*pow(r,2) + 15*pow(r,3)) - 4*pow(r,3)*(426*pow(M,3) - (85 + 108*pow(E,2))*pow(M,2)*r + 12*(-13 + 3*pow(E,2))*M*pow(r,2) + 52*pow(r,3))) - 2*pow(a,5)*E*L*M*r*(-6*pow(L,4)*(18*M + r) + pow(L,2)*(1728*pow(M,3) + 24*(-33 + 10*pow(E,2))*pow(M,2)*r - 4*(83 + 15*pow(E,2))*M*pow(r,2) - 9*pow(r,3)) + 4*r*(-336*pow(M,4) + 2*(-107 + 108*pow(E,2))*pow(M,3)*r + 3*(79 + 36*pow(E,2))*pow(M,2)*pow(r,2) + (161 - 90*pow(E,2))*M*pow(r,3) - 34*pow(r,4))) - pow(a,2)*pow(r,2)*(-2*pow(L,6)*M*(240*pow(M,2) - 154*M*r + 17*pow(r,2)) + 2*pow(L,4)*r*(48*pow(M,4) - 4*(35 + 176*pow(E,2))*pow(M,3)*r + 8*(8 + 15*pow(E,2))*pow(M,2)*pow(r,2) + (-35 + 73*pow(E,2))*M*pow(r,3) + 16*pow(r,4)) + pow(r,5)*(264*pow(M,4) + 4*(-11 + 144*pow(E,2))*pow(M,3)*r + 2*(11 - 222*pow(E,2))*pow(M,2)*pow(r,2) + (-125 + 138*pow(E,2))*M*pow(r,3) + 46*pow(r,4)) + pow(L,2)*pow(r,3)*(1656*pow(M,4) - 12*(65 + 166*pow(E,2))*pow(M,3)*r + 2*(-161 + 374*pow(E,2))*pow(M,2)*pow(r,2) + (47 + 256*pow(E,2))*M*pow(r,3) + 51*pow(r,4))) - pow(a,4)*r*(6*pow(L,6)*M*(12*M + r) + 2*pow(L,4)*(-576*pow(M,4) - 36*(-9 + 20*pow(E,2))*pow(M,3)*r + 2*(-19 + 137*pow(E,2))*pow(M,2)*pow(r,2) + (47 + 29*pow(E,2))*M*pow(r,3) + 8*pow(r,4)) + pow(r,3)*(192*pow(M,5) + 4*(85 + 468*pow(E,2))*pow(M,4)*r + 228*(-1 + 2*pow(E,2))*pow(M,3)*pow(r,2) - 3*(149 + 268*pow(E,2))*pow(M,2)*pow(r,3) - 12*(-9 + pow(E,2))*M*pow(r,4) + 60*pow(r,5)) + pow(L,2)*r*(1344*pow(M,5) + 32*(13 - 105*pow(E,2))*pow(M,4)*r - 4*(243 + 280*pow(E,2))*pow(M,3)*pow(r,2) + 28*(-29 + 75*pow(E,2))*pow(M,2)*pow(r,3) + (391 + 56*pow(E,2))*M*pow(r,4) + 66*pow(r,5))) + 2*pow(a,7)*E*L*M*(4*r*(-8*(5 + 18*pow(E,2))*pow(M,3) + 3*(-59 + 12*pow(E,2))*pow(M,2)*r + (-121 + 72*pow(E,2))*M*pow(r,2) + 6*pow(r,3)) + 3*pow(L,2)*(144*pow(M,2) + pow(r,2) + 4*M*(r + 3*pow(E,2)*r))) + pow(a,8)*(pow(L,2)*M*(-32*(-8 + 27*pow(E,2))*pow(M,2) + 12*(4 - 19*pow(E,2))*M*r + 3*(-41 + 20*pow(E,2))*pow(r,2)) + r*(-(r*(-420*pow(M,3) + 115*pow(M,2)*r + 256*M*pow(r,2) + 7*pow(r,3))) + 4*pow(E,2)*M*(40*pow(M,3) + 178*pow(M,2)*r + 209*M*pow(r,2) + 60*pow(r,3)))) - pow(a,6)*(6*pow(L,4)*M*(48*pow(M,2) + 2*(-5 + 18*pow(E,2))*M*r + (11 + pow(E,2))*pow(r,2)) + pow(L,2)*r*(-32*(5 + 108*pow(E,2))*pow(M,4) + 8*(-88 + 153*pow(E,2))*pow(M,3)*r + 2*(-247 + 658*pow(E,2))*pow(M,2)*pow(r,2) + (417 - 128*pow(E,2))*M*pow(r,3) + 23*pow(r,4)) + pow(r,2)*(4*pow(E,2)*M*(336*pow(M,4) + 324*pow(M,3)*r - 128*pow(M,2)*pow(r,2) - 263*M*pow(r,3) - 66*pow(r,4)) + r*(276*pow(M,4) - 652*pow(M,3)*r - 323*pow(M,2)*pow(r,2) + 350*M*pow(r,3) + 34*pow(r,4)))))/(3.*pow(r,4)*pow(pow(a,2) + r*(-2*M + r),2));
	A160 = -pow(r,5)/2.;
	A162 = (6*pow(a,7)*E*L*M*(12*(-4 + pow(E,2))*M - 11*r) + 3*pow(a,8)*(3*r*(-3*M + r) + 2*pow(E,2)*M*(24*M + 13*r)) + 2*a*E*L*M*(2*M - r)*pow(r,3)*((82*M - 51*r)*pow(r,2) + pow(L,2)*(-124*M + 30*r)) + (2*M - r)*pow(r,3)*(8*pow(L,4)*M*(2*M - r) + pow(L,2)*pow(r,2)*(-36*pow(M,2) + 4*(8 + 11*pow(E,2))*M*r - 7*pow(r,2)) + 8*pow(r,4)*(4*pow(M,2) + (-4 + 5*pow(E,2))*M*r + pow(r,2))) - 2*pow(a,5)*E*L*M*(-12*pow(L,2)*(9*M - 2*r) + r*(8*(-11 + 15*pow(E,2))*pow(M,2) - 24*(-9 + 5*pow(E,2))*M*r + 63*pow(r,2))) - 2*pow(a,3)*E*L*M*r*(pow(L,2)*(360*pow(M,2) - 352*M*r + 54*pow(r,2)) - r*(400*pow(M,3) + 4*(19 - 54*pow(E,2))*pow(M,2)*r + 4*(-40 + 21*pow(E,2))*M*pow(r,2) + 21*pow(r,3))) - pow(a,2)*r*(-8*pow(L,4)*M*(30*pow(M,2) - 29*M*r + 7*pow(r,2)) + pow(r,3)*(88*pow(M,4) + 4*(27 + 64*pow(E,2))*pow(M,3)*r - 2*(57 + 50*pow(E,2))*pow(M,2)*pow(r,2) + (-11 + 26*pow(E,2))*M*pow(r,3) + 15*pow(r,4)) + pow(L,2)*r*(400*pow(M,4) + 8*(-26 + 63*pow(E,2))*pow(M,2)*pow(r,2) + 4*(17 + 4*pow(E,2))*M*pow(r,3) + pow(r,4) - 64*pow(M,3)*(r + 14*pow(E,2)*r))) + pow(a,6)*(-3*pow(L,2)*(24*(-2 + 3*pow(E,2))*pow(M,2) + (4 - 8*pow(E,2))*M*r - 3*pow(r,2)) + r*(r*(86*pow(M,2) - 139*M*r + 19*pow(r,2)) + 2*pow(E,2)*M*(-44*pow(M,2) + 98*M*r + 105*pow(r,2)))) + pow(a,4)*(24*pow(L,4)*M*(-3*M + r) + pow(L,2)*r*(8*(-11 + 90*pow(E,2))*pow(M,3) + 4*(59 - 178*pow(E,2))*pow(M,2)*r + 2*(-41 + 26*pow(E,2))*M*pow(r,2) + pow(r,3)) + pow(r,2)*(r*(-20*pow(M,3) + 296*pow(M,2)*r - 149*M*pow(r,2) + 3*pow(r,3)) + 2*pow(E,2)*M*(-200*pow(M,3) - 108*pow(M,2)*r + 36*M*pow(r,2) + 73*pow(r,3)))))/(12.*r*pow(pow(a,2) + r*(-2*M + r),2));
	A180 = -(pow(r,2)*(60*pow(a,3)*E*L*M + 4*a*E*L*M*r*(8*M + 3*r) - 3*pow(a,4)*(10*pow(E,2)*M + 3*r) + r*(8*pow(L,2)*M*(-2*M + r) + pow(r,2)*(8*pow(M,2) + 2*(-3 + 5*pow(E,2))*M*r + pow(r,2))) - 2*pow(a,2)*(15*pow(L,2)*M + r*(r*(-7*M + 4*r) + 2*pow(E,2)*M*(4*M + 5*r)))))/(48.*(pow(a,2) + r*(-2*M + r)));
	A204 = (48*pow(pow(a,2)*(2*M + r) + r*(pow(L,2) + pow(r,2)),2))/(pow(a,2) + r*(-2*M + r));
	A206 = (8*(pow(a,2)*(2*M + r) + r*(pow(L,2) + pow(r,2)))*(-4*pow(a,7)*E*L*M*(12*pow(M,2) + 23*M*r + 3*pow(r,2)) - 4*a*E*L*M*pow(r,5)*(pow(L,2)*(67*M - 36*r) + (17*M - 15*r)*pow(r,2)) - 4*pow(a,5)*E*L*M*r*(-64*pow(M,3) - 104*pow(M,2)*r + 55*M*pow(r,2) + 7*pow(r,3) + 3*pow(L,2)*(8*M + r)) + pow(a,8)*M*(-(r*(M + 6*r)) + 12*pow(E,2)*(2*pow(M,2) + 3*M*r + pow(r,2))) + 4*pow(a,3)*E*L*M*pow(r,2)*(pow(L,2)*(16*pow(M,2) - 73*M*r + 3*pow(r,2)) + pow(r,2)*(196*pow(M,2) - 17*M*r + 11*pow(r,2))) + pow(r,5)*(8*pow(L,4)*(10*pow(M,2) - 11*M*r + 3*pow(r,2)) + pow(r,4)*(40*pow(M,2) - 2*(19 + 2*pow(E,2))*M*r + 9*pow(r,2)) + 2*pow(L,2)*pow(r,2)*(54*pow(M,2) + (-57 + 2*pow(E,2))*M*r + 15*pow(r,2))) - 2*pow(a,2)*pow(r,2)*(pow(r,4)*(58*pow(M,3) + 3*(-23 + 26*pow(E,2))*pow(M,2)*r + 33*M*pow(r,2) - 6*pow(r,3)) + 2*pow(L,4)*(8*pow(M,3) - 33*pow(M,2)*r + 10*M*pow(r,2) + 3*pow(r,3)) - pow(L,2)*pow(r,2)*(-194*pow(M,3) + (171 + 104*pow(E,2))*pow(M,2)*r + (-57 + 10*pow(E,2))*M*pow(r,2) + 6*pow(r,3))) + pow(a,4)*r*(48*pow(L,4)*pow(M,2) + pow(r,2)*(4*pow(M,4) + 20*(1 - 18*pow(E,2))*pow(M,3)*r - 3*(-53 + 76*pow(E,2))*pow(M,2)*pow(r,2) + 12*(-7 + 2*pow(E,2))*M*pow(r,3) - 3*pow(r,4)) - 2*pow(L,2)*(64*pow(M,4) + 8*(11 + 2*pow(E,2))*pow(M,3)*r - (109 + 80*pow(E,2))*pow(M,2)*pow(r,2) + (51 - 14*pow(E,2))*M*pow(r,3) + 9*pow(r,4))) + 2*pow(a,6)*(pow(L,2)*M*(12*pow(M,2) + 4*(7 + 6*pow(E,2))*M*r + 3*(-1 + 2*pow(E,2))*pow(r,2)) - r*(pow(r,3)*(31*M + 3*r) + 2*pow(E,2)*M*(32*pow(M,3) + 60*pow(M,2)*r + 9*M*pow(r,2) - 8*pow(r,3))))))/(3.*pow(r,6)*pow(pow(a,2) + r*(-2*M + r),2));
	A222 = (24*pow(r,3)*(pow(a,2)*(2*M + r) + r*(pow(L,2) + pow(r,2))))/(pow(a,2) + r*(-2*M + r));
	A224 = (2*(4*pow(a,7)*E*L*M*(24*pow(M,2) + 19*M*r + 9*pow(r,2)) - 4*a*E*L*M*pow(r,3)*(4*pow(L,4)*M + 9*pow(L,2)*(12*M - 7*r)*pow(r,2) + 6*(9*M - 7*r)*pow(r,4)) + 4*pow(a,5)*E*L*M*r*(48*pow(M,3) + 142*pow(M,2)*r + 76*M*pow(r,2) + 50*pow(r,3) + pow(L,2)*(-6*M + 9*r)) - pow(a,8)*(24*pow(E,2)*pow(M,2)*(2*M + r) + r*(49*pow(M,2) + 42*M*r + 6*pow(r,2))) + pow(r,3)*(4*pow(L,6)*M*(2*M - r) + 12*pow(L,2)*pow(r,4)*(28*pow(M,2) - 32*M*r + 9*pow(r,2)) + 3*pow(r,6)*(40*pow(M,2) - 2*(23 + 2*pow(E,2))*M*r + 13*pow(r,2)) + 2*pow(L,4)*pow(r,2)*(118*pow(M,2) + (-131 + 2*pow(E,2))*M*r + 36*pow(r,2))) + 4*pow(a,3)*E*L*M*pow(r,3)*(-6*pow(L,2)*(9*M - 8*r) + r*(114*pow(M,2) + 23*M*r + 83*pow(r,2))) + 2*pow(a,2)*pow(r,3)*(pow(L,4)*(4*(18 + pow(E,2))*pow(M,2) + (-71 + 2*pow(E,2))*M*r + 15*pow(r,2)) - 3*pow(r,3)*(12*pow(M,3) + 2*(-7 + 24*pow(E,2))*pow(M,2)*r + (31 + 6*pow(E,2))*M*pow(r,2) - 15*pow(r,3)) + 3*pow(L,2)*r*(-32*pow(M,3) + 2*(19 + 9*pow(E,2))*pow(M,2)*r - 61*M*pow(r,2) + 25*pow(r,3))) + pow(a,4)*r*(6*pow(L,4)*(2*pow(M,2) - 6*M*r - pow(r,2)) - 3*pow(r,2)*(76*pow(M,4) + 12*(-1 + 16*pow(E,2))*pow(M,3)*r + 3*(-19 + 56*pow(E,2))*pow(M,2)*pow(r,2) + 4*(7 + 3*pow(E,2))*M*pow(r,3) - 19*pow(r,4)) - 2*pow(L,2)*(48*pow(M,4) + 68*pow(M,3)*r - 4*(13 + 9*pow(E,2))*pow(M,2)*pow(r,2) + 84*M*pow(r,3) - 15*pow(r,4))) - 2*pow(a,6)*(pow(L,2)*(24*pow(M,3) + (26 - 6*pow(E,2))*pow(M,2)*r + 39*M*pow(r,2) + 6*pow(r,3)) + M*r*(r*(-106*pow(M,2) - 37*M*r + 39*pow(r,2)) + 6*pow(E,2)*(8*pow(M,3) + 36*pow(M,2)*r + 20*M*pow(r,2) + pow(r,3))))))/(3.*pow(r,3)*pow(pow(a,2) + r*(-2*M + r),2));
	A240 = (3*pow(r,6))/(pow(a,2) + r*(-2*M + r));
	A242 = (24*pow(a,5)*E*L*M*(7*M + 4*r) + 12*pow(a,3)*E*L*M*r*(4*pow(L,2) - 16*pow(M,2) + 9*M*r + 23*pow(r,2)) - 12*a*E*L*M*pow(r,2)*(pow(L,2)*(8*M - 4*r) + (19*M - 13*r)*pow(r,2)) - 3*pow(a,6)*(4*pow(E,2)*M*(7*M + 3*r) + r*(10*M + 3*r)) + pow(r,2)*(24*pow(L,4)*M*(2*M - r) + pow(r,4)*(120*pow(M,2) - 2*(71 + 6*pow(E,2))*M*r + 41*pow(r,2)) + pow(L,2)*pow(r,2)*(228*pow(M,2) - 232*M*r + 59*pow(r,2))) + pow(a,2)*r*(-24*pow(L,4)*M + pow(r,2)*(-36*pow(M,3) + (22 - 84*pow(E,2))*pow(M,2)*r - 6*(19 + 10*pow(E,2))*M*pow(r,2) + 67*pow(r,3)) + 2*pow(L,2)*(48*pow(M,3) - 6*(13 + 2*pow(E,2))*M*pow(r,2) + 25*pow(r,3) + 6*pow(M,2)*(r + 4*pow(E,2)*r))) - pow(a,4)*(3*pow(L,2)*(28*pow(M,2) + 4*(5 + 2*pow(E,2))*M*r + 3*pow(r,2)) + r*(r*(-78*pow(M,2) + 14*M*r - 17*pow(r,2)) + 12*pow(E,2)*M*(-8*pow(M,2) + 10*M*r + 7*pow(r,2)))))/(6.*pow(pow(a,2) + r*(-2*M + r),2));
	A260 = (pow(r,3)*(48*pow(a,3)*E*L*M - 3*pow(a,4)*(8*pow(E,2)*M + r) + 16*a*E*L*M*r*(-5*M + 3*r) + r*(20*pow(L,2)*M*(2*M - r) + pow(r,2)*(40*pow(M,2) - 2*(21 + 2*pow(E,2))*M*r + 11*pow(r,2))) - 2*pow(a,2)*(12*pow(L,2)*M + r*((7*M - 4*r)*r + 2*pow(E,2)*M*(-10*M + 7*r)))))/(24.*pow(pow(a,2) + r*(-2*M + r),2));
	A304 = (-8*(pow(a,2)*(2*M + r) + r*(pow(L,2) + pow(r,2)))*(4*pow(a,3)*E*L*M + pow(a,4)*r + 12*a*E*L*M*pow(r,2) + pow(r,2)*(pow(r,2)*(-5*M + 2*r) + pow(L,2)*(-9*M + 4*r)) + pow(a,2)*(pow(L,2)*(-4*M + r) + r*(2*pow(M,2) - 3*M*r + 3*pow(r,2)))))/(r*pow(pow(a,2) + r*(-2*M + r),2));
	A306 = (4*(-4*pow(a,11)*E*L*pow(M,2)*(4*(35 + 9*pow(E,2))*pow(M,2) + (127 + 54*pow(E,2))*M*r + 3*(5 + 6*pow(E,2))*pow(r,2)) - 2*a*E*L*M*pow(r,5)*(pow(r,6)*(-184*pow(M,2) + 12*(17 + 9*pow(E,2))*M*r - 57*pow(r,2)) + pow(L,2)*pow(r,4)*(212*pow(M,2) + 4*(-23 + 57*pow(E,2))*M*r - 3*pow(r,2)) + 42*pow(L,6)*(4*pow(M,2) - pow(r,2)) + 2*pow(L,4)*pow(r,2)*(486*pow(M,2) + 2*(-170 + 21*pow(E,2))*M*r + 51*pow(r,2))) - 2*pow(a,3)*E*L*M*pow(r,3)*(4*pow(L,4)*pow(r,2)*((829 + 42*pow(E,2))*pow(M,2) + 2*(-107 + 21*pow(E,2))*M*r - 84*pow(r,2)) + 42*pow(L,6)*(12*pow(M,2) - 2*M*r - pow(r,2)) + pow(r,5)*(-3444*pow(M,3) + 2*(961 - 270*pow(E,2))*pow(M,2)*r + 4*(106 + 135*pow(E,2))*M*pow(r,2) - 257*pow(r,3)) + 2*pow(L,2)*pow(r,3)*(-3230*pow(M,3) + 3*(895 + 224*pow(E,2))*pow(M,2)*r + (-109 + 384*pow(E,2))*M*pow(r,2) - 214*pow(r,3))) + pow(r,7)*(2*pow(L,6)*(2*M - r)*(54*pow(M,2) + (-71 + 42*pow(E,2))*M*r + 24*pow(r,2)) + pow(L,4)*pow(r,2)*(272*pow(M,3) + 2*(-247 + 222*pow(E,2))*pow(M,2)*r + (311 - 226*pow(E,2))*M*pow(r,2) - 66*pow(r,3)) + pow(L,2)*pow(r,4)*(220*pow(M,3) + 340*(-1 + pow(E,2))*pow(M,2)*r + (193 - 184*pow(E,2))*M*pow(r,2) - 39*pow(r,3)) + pow(r,6)*(116*pow(M,3) + 2*(-83 + 44*pow(E,2))*pow(M,2)*r + 6*(14 - 9*pow(E,2))*M*pow(r,2) - 15*pow(r,3))) + pow(a,12)*M*(3*r*(-8*pow(M,2) - 3*M*r + 2*pow(r,2)) + pow(E,2)*(280*pow(M,3) + 308*pow(M,2)*r + 72*M*pow(r,2) - 6*pow(r,3))) - 4*pow(a,9)*E*L*M*(pow(L,2)*M*(108*pow(M,2) + 2*(137 + 24*pow(E,2))*M*r + 3*(13 + 6*pow(E,2))*pow(r,2)) + r*(24*(-1 + 12*pow(E,2))*pow(M,4) + 2*(215 + 234*pow(E,2))*pow(M,3)*r + 12*(49 + 39*pow(E,2))*pow(M,2)*pow(r,2) + 9*(-5 + 18*pow(E,2))*M*pow(r,3) - 30*pow(r,4))) - pow(a,2)*pow(r,3)*(-168*pow(L,8)*pow(M,2)*(2*M - r) + pow(L,4)*pow(r,3)*(4168*pow(M,4) - 4*(1441 + 1086*pow(E,2))*pow(M,3)*r + 4*(583 + 6*pow(E,2))*pow(M,2)*pow(r,2) + (-85 + 732*pow(E,2))*M*pow(r,3) - 81*pow(r,4)) + 2*pow(L,6)*r*(240*pow(M,4) - 4*(233 + 84*pow(E,2))*pow(M,3)*r - 6*(-83 + 28*pow(E,2))*pow(M,2)*pow(r,2) + (23 + 84*pow(E,2))*M*pow(r,3) - 36*pow(r,4)) + pow(L,2)*pow(r,5)*(3640*pow(M,4) + 12*(-413 + 58*pow(E,2))*pow(M,3)*r + 2*(1091 - 1004*pow(E,2))*pow(M,2)*pow(r,2) + (-243 + 800*pow(E,2))*M*pow(r,3) - 27*pow(r,4)) + pow(r,7)*(696*pow(M,4) + 4*(-315 + 274*pow(E,2))*pow(M,3)*r + 4*(204 - 241*pow(E,2))*pow(M,2)*pow(r,2) + (-205 + 268*pow(E,2))*M*pow(r,3) + 15*pow(r,4))) - 2*pow(a,5)*E*L*M*pow(r,2)*(2*pow(L,4)*(1008*pow(M,3) + 4*(257 + 21*pow(E,2))*pow(M,2)*r + 2*(-104 + 21*pow(E,2))*M*pow(r,2) - 87*pow(r,3)) + pow(L,2)*r*(-1888*pow(M,4) + 20*(-161 + 24*pow(E,2))*pow(M,3)*r + 288*(21 + 8*pow(E,2))*pow(M,2)*pow(r,2) + 12*(-89 + 74*pow(E,2))*M*pow(r,3) - 617*pow(r,4)) - pow(r,3)*(768*pow(M,4) + 4*(823 + 378*pow(E,2))*pow(M,3)*r + 4*(-1091 + 18*pow(E,2))*pow(M,2)*pow(r,2) - 18*(-1 + 56*pow(E,2))*M*pow(r,3) + 403*pow(r,4))) + pow(a,4)*pow(r,2)*(2*pow(L,6)*M*(672*pow(M,3) + 4*(101 + 126*pow(E,2))*pow(M,2)*r + 28*(-11 + 3*pow(E,2))*M*pow(r,2) - (31 + 42*pow(E,2))*pow(r,3)) + pow(r,5)*(180*pow(M,5) + 12*(1 - 238*pow(E,2))*pow(M,4)*r - 9*(-161 + 60*pow(E,2))*pow(M,3)*pow(r,2) + 8*(-219 + 287*pow(E,2))*pow(M,2)*pow(r,3) + (421 - 538*pow(E,2))*M*pow(r,4) + 45*pow(r,5)) + pow(L,4)*r*(-1888*pow(M,5) + 8*(-239 + 180*pow(E,2))*pow(M,4)*r + 32*(163 + 293*pow(E,2))*pow(M,3)*pow(r,2) + 12*(-223 + 58*pow(E,2))*pow(M,2)*pow(r,3) + 2*(79 - 396*pow(E,2))*M*pow(r,4) + 147*pow(r,5)) + pow(L,2)*pow(r,3)*(-364*pow(M,5) - 4*(763 + 2976*pow(E,2))*pow(M,4)*r + (6129 + 4072*pow(E,2))*pow(M,3)*pow(r,2) + 4*(-965 + 831*pow(E,2))*pow(M,2)*pow(r,3) + 3*(181 - 436*pow(E,2))*M*pow(r,4) + 171*pow(r,5))) - 2*pow(a,7)*E*L*M*r*(48*pow(L,4)*M*(6*M + r) + 2*pow(L,2)*(864*pow(M,4) + 4*(163 + 84*pow(E,2))*pow(M,3)*r + (1271 + 624*pow(E,2))*pow(M,2)*pow(r,2) + 2*(-101 + 96*pow(E,2))*M*pow(r,3) - 96*pow(r,4)) - r*(896*pow(M,5) + 1840*pow(M,4)*r + 36*(17 + 2*pow(E,2))*pow(M,3)*pow(r,2) - 4*(769 + 324*pow(E,2))*pow(M,2)*pow(r,3) + 2*(179 - 432*pow(E,2))*M*pow(r,4) + 263*pow(r,5))) + pow(a,6)*r*(6*pow(L,6)*M*(32*pow(M,2) + 2*M*r + pow(r,2)) + 4*pow(L,4)*M*(288*pow(M,4) + 4*(23 + 252*pow(E,2))*pow(M,3)*r + (389 + 1450*pow(E,2))*pow(M,2)*pow(r,2) + 2*(-125 + 69*pow(E,2))*M*pow(r,3) - (6 + 73*pow(E,2))*pow(r,4)) + pow(r,3)*(184*pow(M,6) - 4*(11 + 268*pow(E,2))*pow(M,5)*r - 6*(37 + 632*pow(E,2))*pow(M,4)*pow(r,2) + (77 + 2080*pow(E,2))*pow(M,3)*pow(r,3) + (-1231 + 2360*pow(E,2))*pow(M,2)*pow(r,4) + 3*(203 - 184*pow(E,2))*M*pow(r,5) + 75*pow(r,6)) + pow(L,2)*r*(-896*pow(M,6) - 32*(38 + 59*pow(E,2))*pow(M,5)*r - 16*(21 + 292*pow(E,2))*pow(M,4)*pow(r,2) + 2*(1643 + 4488*pow(E,2))*pow(M,3)*pow(r,3) + (-1991 + 2372*pow(E,2))*pow(M,2)*pow(r,4) + (571 - 964*pow(E,2))*M*pow(r,5) + 105*pow(r,6))) + pow(a,10)*M*(pow(L,2)*(8*(35 + 54*pow(E,2))*pow(M,3) + 8*(25 + 109*pow(E,2))*pow(M,2)*r + 3*(-7 + 76*pow(E,2))*M*pow(r,2) + 6*(3 - 2*pow(E,2))*pow(r,3)) + r*(r*(134*pow(M,3) - 21*pow(M,2)*r - 69*M*pow(r,2) + 58*pow(r,3)) + pow(E,2)*(-48*pow(M,4) + 1072*pow(M,3)*r + 1704*pow(M,2)*pow(r,2) + 452*M*pow(r,3) - 76*pow(r,4)))) + pow(a,8)*(2*pow(L,4)*M*(72*pow(M,3) + 4*(55 + 72*pow(E,2))*pow(M,2)*r + 78*pow(E,2)*M*pow(r,2) - 3*(-3 + pow(E,2))*pow(r,3)) + pow(L,2)*M*r*(48*(-1 + 72*pow(E,2))*pow(M,4) + 8*(81 + 514*pow(E,2))*pow(M,3)*r + (869 + 5400*pow(E,2))*pow(M,2)*pow(r,2) + 2*(-285 + 472*pow(E,2))*M*pow(r,3) + 4*(24 - 71*pow(E,2))*pow(r,4)) + pow(r,2)*(r*(-264*pow(M,5) + 92*pow(M,4)*r + 135*pow(M,3)*pow(r,2) - 189*pow(M,2)*pow(r,3) + 361*M*pow(r,4) + 30*pow(r,5)) - 2*pow(E,2)*M*(448*pow(M,5) + 1232*pow(M,4)*r + 680*pow(M,3)*pow(r,2) - 1460*pow(M,2)*pow(r,3) - 660*M*pow(r,4) + 149*pow(r,5))))))/(3.*pow(r,7)*pow(pow(a,2) + r*(-2*M + r),3));
	A322 = (-4*pow(r,2)*(2*pow(a,3)*E*L*M + 6*a*E*L*M*pow(r,2) + pow(a,4)*(3*M + 2*r) + pow(r,2)*(pow(r,2)*(-5*M + 2*r) + pow(L,2)*(-7*M + 3*r)) - 2*pow(a,2)*(pow(L,2)*(M - r) + r*(2*pow(M,2) + M*r - 2*pow(r,2)))))/pow(pow(a,2) + r*(-2*M + r),2);
	A324 = (4*pow(a,9)*E*L*M*(2*(-113 + 9*pow(E,2))*pow(M,2) - 57*M*r + 3*pow(r,2)) - 4*a*E*L*M*pow(r,4)*(pow(L,4)*(240*pow(M,2) - 22*M*r - 51*pow(r,2)) + pow(L,2)*pow(r,2)*(314*pow(M,2) + (-83 + 114*pow(E,2))*M*r - 42*pow(r,2)) + 3*pow(r,4)*(-84*pow(M,2) + 4*(26 + 9*pow(E,2))*M*r - 33*pow(r,2))) + pow(a,10)*M*(-21*r*(7*M + 2*r) + 4*pow(E,2)*(113*pow(M,2) + 81*M*r + 9*pow(r,2))) - 4*pow(a,7)*E*L*M*(3*pow(L,2)*(-18*pow(M,2) + 8*M*r + pow(r,2)) + r*(4*(31 + 108*pow(E,2))*pow(M,3) + 9*(109 + 30*pow(E,2))*pow(M,2)*r + (37 + 108*pow(E,2))*M*pow(r,2) - 69*pow(r,3))) - 4*pow(a,3)*E*L*M*pow(r,2)*(pow(L,4)*(612*pow(M,2) - 92*M*r - 45*pow(r,2)) + pow(r,3)*(-2250*pow(M,3) + (955 - 54*pow(E,2))*pow(M,2)*r + 9*(49 + 36*pow(E,2))*M*pow(r,2) - 211*pow(r,3)) + pow(L,2)*r*(16*pow(M,3) + 2*(409 + 114*pow(E,2))*pow(M,2)*r + 2*(-185 + 108*pow(E,2))*M*pow(r,2) - 45*pow(r,3))) + pow(r,4)*(2*pow(L,6)*M*(12*pow(M,2) - 16*M*r + 5*pow(r,2)) + pow(L,2)*pow(r,4)*(304*pow(M,3) + 2*(-243 + 340*pow(E,2))*pow(M,2)*r + (257 - 368*pow(E,2))*M*pow(r,2) - 45*pow(r,3)) + 2*pow(L,4)*pow(r,2)*(128*pow(M,3) + 2*(-113 + 111*pow(E,2))*pow(M,2)*r + (129 - 113*pow(E,2))*M*pow(r,2) - 24*pow(r,3)) + 3*pow(r,6)*(116*pow(M,3) + 2*(-85 + 44*pow(E,2))*pow(M,2)*r + 2*(41 - 27*pow(E,2))*M*pow(r,2) - 13*pow(r,3))) - 4*pow(a,5)*E*L*M*r*(6*pow(L,4)*r + pow(L,2)*(1296*pow(M,3) + 6*(47 + 34*pow(E,2))*pow(M,2)*r + (-371 + 102*pow(E,2))*M*pow(r,2) - 60*pow(r,3)) + r*(-1008*pow(M,4) + 2*(-641 + 216*pow(E,2))*pow(M,3)*r + 6*(335 + 63*pow(E,2))*pow(M,2)*pow(r,2) + (209 + 324*pow(E,2))*M*pow(r,3) - 178*pow(r,4))) + pow(a,2)*pow(r,2)*(2*pow(L,6)*M*(408*pow(M,2) - 194*M*r - 5*pow(r,2)) - 8*pow(L,4)*M*r*(104*pow(M,3) - 3*(73 + 77*pow(E,2))*pow(M,2)*r + (115 - 101*pow(E,2))*M*pow(r,2) + 17*(-1 + 3*pow(E,2))*pow(r,3)) - 3*pow(r,5)*(464*pow(M,4) + 4*(-187 + 194*pow(E,2))*pow(M,3)*r - 8*(-66 + 83*pow(E,2))*pow(M,2)*pow(r,2) + 2*(-83 + 98*pow(E,2))*M*pow(r,3) + 15*pow(r,4)) + pow(L,2)*pow(r,3)*(-4696*pow(M,4) + 8*(672 + 127*pow(E,2))*pow(M,3)*r + 6*(-347 + 324*pow(E,2))*pow(M,2)*pow(r,2) - 3*(-87 + 352*pow(E,2))*M*pow(r,3) + 15*pow(r,4))) + pow(a,4)*r*(12*pow(L,6)*M*r + 3*pow(r,3)*(60*pow(M,5) - 4*(23 + 326*pow(E,2))*pow(M,4)*r + (751 - 436*pow(E,2))*pow(M,3)*pow(r,2) + 2*(-387 + 586*pow(E,2))*pow(M,2)*pow(r,3) - 4*(-50 + 63*pow(E,2))*M*pow(r,4) + 19*pow(r,5)) + 2*pow(L,2)*r*(-1008*pow(M,5) + 4*(-227 + 328*pow(E,2))*pow(M,4)*r + 2*(1325 + 758*pow(E,2))*pow(M,3)*pow(r,2) + 14*(-95 + 6*pow(E,2))*pow(M,2)*pow(r,3) + 3*(39 - 160*pow(E,2))*M*pow(r,4) + 69*pow(r,5)) + 2*pow(L,4)*(864*pow(M,4) + 2*(-193 + 107*pow(E,2))*pow(M,2)*pow(r,2) + 17*(1 - 5*pow(E,2))*M*pow(r,3) + 24*pow(r,4) + 12*pow(M,3)*(r + 102*pow(E,2)*r))) + pow(a,8)*(2*pow(L,2)*M*((226 - 108*pow(E,2))*pow(M,2) + 24*(-2 + pow(E,2))*M*r + 3*(-15 + 8*pow(E,2))*pow(r,2)) + r*(2*pow(E,2)*M*(124*pow(M,3) + 982*pow(M,2)*r + 686*M*pow(r,2) + 3*pow(r,3)) + 3*r*(179*pow(M,3) - 70*pow(M,2)*r + 30*M*pow(r,2) + 10*pow(r,3)))) + pow(a,6)*(-12*pow(L,4)*M*(6*pow(M,2) - 4*M*r - (-3 + pow(E,2))*pow(r,2)) + 2*pow(L,2)*r*(4*(31 + 648*pow(E,2))*pow(M,4) + 28*(35 + 39*pow(E,2))*pow(M,3)*r - (361 + 140*pow(E,2))*pow(M,2)*pow(r,2) + (43 - 112*pow(E,2))*M*pow(r,3) + 39*pow(r,4)) + pow(r,2)*(3*r*(-192*pow(M,4) + 210*pow(M,3)*r - 381*pow(M,2)*pow(r,2) + 160*M*pow(r,3) + 31*pow(r,4)) - 4*pow(E,2)*M*(504*pow(M,4) + 828*pow(M,3)*r - 433*pow(M,2)*pow(r,2) - 709*M*pow(r,3) + 90*pow(r,4)))))/(3.*pow(r,4)*pow(pow(a,2) + r*(-2*M + r),3));
	A340 = -(pow(r,5)*(3*pow(a,2) + r*(-5*M + 2*r)))/(2.*pow(pow(a,2) + r*(-2*M + r),2));
	A342 = (24*pow(a,7)*E*L*M*((-25 + 3*pow(E,2))*M - 7*r) + 3*pow(a,8)*(r*(8*M + 9*r) + 2*pow(E,2)*M*(50*M + 19*r)) - 4*a*E*L*M*pow(r,3)*(3*pow(r,2)*(-76*pow(M,2) + (103 + 18*pow(E,2))*M*r - 36*pow(r,2)) + pow(L,2)*(208*pow(M,2) - 64*M*r - 27*pow(r,2))) - 12*pow(a,5)*E*L*M*(pow(L,2)*(-18*M + 8*r) + r*((4 + 48*pow(E,2))*pow(M,2) + (71 - 6*pow(E,2))*M*r + 20*pow(r,2))) - 12*pow(a,3)*E*L*M*r*(pow(L,2)*(144*pow(M,2) - 64*M*r - pow(r,2)) + 2*r*(-88*pow(M,3) + 2*(-5 + 18*pow(E,2))*pow(M,2)*r + 9*(4 + pow(E,2))*M*pow(r,2) - 13*pow(r,3))) + pow(r,3)*(-8*pow(L,4)*M*(2*pow(M,2) - 3*M*r + pow(r,2)) + pow(r,4)*(348*pow(M,3) + 8*(-64 + 33*pow(E,2))*pow(M,2)*r + (245 - 162*pow(E,2))*M*pow(r,2) - 38*pow(r,3)) + pow(L,2)*pow(r,2)*(-52*pow(M,3) + 4*(19 + 85*pow(E,2))*pow(M,2)*r - (33 + 184*pow(E,2))*M*pow(r,2) + 4*pow(r,3))) - pow(a,2)*r*(-12*pow(L,4)*M*(48*pow(M,2) - 29*M*r + pow(r,2)) + pow(L,2)*r*(1056*pow(M,4) - 16*(33 + 107*pow(E,2))*pow(M,3)*r + 4*(-35 + 16*pow(E,2))*pow(M,2)*pow(r,2) + 4*(9 + 64*pow(E,2))*M*pow(r,3) + 25*pow(r,4)) + pow(r,3)*(696*pow(M,4) + 8*(-103 + 171*pow(E,2))*pow(M,3)*r + 4*(166 - 273*pow(E,2))*pow(M,2)*pow(r,2) + 3*(-111 + 124*pow(E,2))*M*pow(r,3) + 57*pow(r,4))) + pow(a,6)*(pow(L,2)*((300 - 216*pow(E,2))*pow(M,2) + 6*(9 + 8*pow(E,2))*M*r + 27*pow(r,2)) + r*(12*pow(E,2)*M*(2*pow(M,2) + 61*M*r + 15*pow(r,2)) + r*(-312*pow(M,2) - 25*M*r + 61*pow(r,2)))) + pow(a,4)*(24*pow(L,4)*M*(-3*M + 2*r) + pow(L,2)*r*(24*(1 + 72*pow(E,2))*pow(M,3) + 12*(10 - 41*pow(E,2))*pow(M,2)*r - 3*(23 + 8*pow(E,2))*M*pow(r,2) - 2*pow(r,3)) + pow(r,2)*(-12*pow(E,2)*M*(88*pow(M,3) + 64*pow(M,2)*r - 97*M*pow(r,2) + 12*pow(r,3)) + r*(876*pow(M,3) - 512*pow(M,2)*r + 63*M*pow(r,2) + 15*pow(r,3)))))/(12.*r*pow(pow(a,2) + r*(-2*M + r),3));
	A360 = (pow(r,2)*(-144*pow(a,5)*E*L*M + 28*pow(a,3)*E*L*M*(4*M - 3*r)*r + 3*pow(a,6)*(24*pow(E,2)*M + 7*r) + 4*a*E*L*M*pow(r,2)*(68*pow(M,2) - 54*M*r + 15*pow(r,2)) + pow(r,2)*(-2*pow(L,2)*M*(68*pow(M,2) - 76*M*r + 21*pow(r,2)) + pow(r,2)*(116*pow(M,3) + 8*(-21 + 11*pow(E,2))*pow(M,2)*r + (83 - 54*pow(E,2))*M*pow(r,2) - 14*pow(r,3))) + pow(a,4)*(72*pow(L,2)*M + r*(r*(-53*M + 28*r) + pow(E,2)*(-56*pow(M,2) + 74*M*r))) - pow(a,2)*r*(2*pow(L,2)*M*(28*M - 5*r) + r*(r*(36*pow(M,2) - 30*M*r + 7*pow(r,2)) + 4*pow(E,2)*M*(34*pow(M,2) - 16*M*r + 13*pow(r,2))))))/(48.*pow(pow(a,2) + r*(-2*M + r),3));
	A402 = (12*pow(r,3)*(pow(a,2)*(2*M + r) + r*(pow(L,2) + pow(r,2))))/pow(pow(a,2) + r*(-2*M + r),2);
	A404 = (2*(-4*pow(a,7)*E*L*M*(48*pow(M,2) + 40*M*r + 3*pow(r,2)) - 4*pow(a,5)*E*L*M*r*(-96*pow(M,3) - 110*pow(M,2)*r + 73*M*pow(r,2) + 8*pow(r,3) + 9*pow(L,2)*(6*M + r)) + pow(a,8)*(12*pow(E,2)*M*(8*pow(M,2) + 10*M*r + 3*pow(r,2)) - r*(62*pow(M,2) + 42*M*r + 3*pow(r,2))) + pow(r,3)*(4*pow(L,6)*M*(-2*M + r) + 3*pow(r,6)*(23*pow(M,2) + 4*(-5 + pow(E,2))*M*r + 3*pow(r,2)) + 3*pow(L,2)*pow(r,4)*(42*pow(M,2) + 4*(-9 + 2*pow(E,2))*M*r + 5*pow(r,2)) + pow(L,4)*pow(r,2)*(73*pow(M,2) + 4*(-17 + 2*pow(E,2))*M*r + 12*pow(r,2))) - 4*pow(a,3)*E*L*M*pow(r,2)*(6*pow(L,4) + pow(L,2)*(-48*pow(M,2) + 81*M*r + 9*pow(r,2)) + pow(r,2)*(-234*pow(M,2) + 50*M*r + 17*pow(r,2))) + 4*a*E*L*M*pow(r,3)*(pow(L,4)*(4*M - 6*r) + 3*(M - 4*r)*pow(r,4) + pow(L,2)*(-45*M*pow(r,2) + 6*pow(r,3))) + pow(a,2)*pow(r,2)*(12*pow(L,6)*M + 6*pow(r,4)*(-16*pow(M,3) + (26 - 36*pow(E,2))*pow(M,2)*r + (-25 + 12*pow(E,2))*M*pow(r,2) + 6*pow(r,3)) + 3*pow(L,2)*pow(r,2)*(-152*pow(M,3) + 4*(35 + 9*pow(E,2))*pow(M,2)*r + 2*(-33 + 16*pow(E,2))*M*pow(r,2) + 19*pow(r,3)) + pow(L,4)*(-96*pow(M,3) + 4*(39 - 2*pow(E,2))*pow(M,2)*r + 10*(-5 + 2*pow(E,2))*M*pow(r,2) + 24*pow(r,3))) + pow(a,4)*r*(3*pow(L,4)*(36*pow(M,2) + 4*(-1 + pow(E,2))*M*r - pow(r,2)) - 2*pow(L,2)*(96*pow(M,4) + 4*(19 + 12*pow(E,2))*pow(M,3)*r - (143 + 84*pow(E,2))*pow(M,2)*pow(r,2) + 15*(3 - 4*pow(E,2))*M*pow(r,3) - 18*pow(r,4)) - 3*pow(r,2)*(36*pow(M,4) + 4*(-5 + 48*pow(E,2))*pow(M,3)*r + 9*(-5 + 8*pow(E,2))*pow(M,2)*pow(r,2) + 2*(19 - 24*pow(E,2))*M*pow(r,3) - 14*pow(r,4))) + 2*pow(a,6)*(pow(L,2)*(48*pow(M,3) + 2*(10 + 27*pow(E,2))*pow(M,2)*r + 3*(-11 + 8*pow(E,2))*M*pow(r,2) - 3*pow(r,3)) + r*(-12*pow(E,2)*M*(8*pow(M,3) + 12*pow(M,2)*r - 5*M*pow(r,2) - 5*pow(r,3)) + r*(74*pow(M,3) + 17*pow(M,2)*r - 33*M*pow(r,2) + 6*pow(r,3))))))/(3.*pow(r,3)*pow(pow(a,2) + r*(-2*M + r),3));
	A420 = (3*pow(r,6))/pow(pow(a,2) + r*(-2*M + r),2);
	A422 = (2*pow(a,5)*E*L*M*(-8*M + r) - 2*pow(a,3)*E*L*M*r*(4*pow(L,2) - 8*pow(M,2) + M*r - 7*pow(r,2)) - 2*a*E*L*M*pow(r,3)*(4*pow(L,2) + r*(3*M + 4*r)) + pow(a,6)*M*(-7*r + pow(E,2)*(8*M + 6*r)) + pow(r,4)*(pow(r,2)*(23*pow(M,2) + 2*(-11 + 2*pow(E,2))*M*r + 4*pow(r,2)) + pow(L,2)*(25*pow(M,2) + (-23 + 4*pow(E,2))*M*r + 4*pow(r,2))) + pow(a,2)*r*(4*pow(L,4)*M + pow(r,2)*(-16*pow(M,3) - 4*(-5 + 8*pow(E,2))*pow(M,2)*r + 7*(-5 + 2*pow(E,2))*M*pow(r,2) + 14*pow(r,3)) + pow(L,2)*(-8*pow(M,3) + 10*pow(M,2)*r + (-23 + 8*pow(E,2))*M*pow(r,2) + 15*pow(r,3))) + pow(a,4)*(4*pow(L,2)*M*(2*M + (-2 + pow(E,2))*r) + r*(-8*pow(E,2)*M*(pow(M,2) + M*r - 2*pow(r,2)) + r*(17*pow(M,2) - 8*M*r + 10*pow(r,2)))))/pow(pow(a,2) + r*(-2*M + r),3);
	A440 = (pow(r,4)*(9*pow(a,4) - 48*a*E*L*pow(M,2) + 12*pow(L,2)*M*(2*M - r) + pow(r,2)*(69*pow(M,2) + 2*(-31 + 6*pow(E,2))*M*r + 10*pow(r,2)) + 2*pow(a,2)*(6*pow(E,2)*M*(2*M + r) + r*(-30*M + 17*r))))/(24.*pow(pow(a,2) + r*(-2*M + r),3));
	A502 = (-2*pow(r,2)*(2*pow(a,3)*E*L*M + 6*a*E*L*M*pow(r,2) + pow(a,4)*(3*M + 2*r) + pow(r,2)*(pow(r,2)*(-4*M + r) + pow(L,2)*(-6*M + 2*r)) + pow(a,2)*(-2*pow(L,2)*(M - r) + r*(-2*pow(M,2) - 3*M*r + 3*pow(r,2)))))/pow(pow(a,2) + r*(-2*M + r),3);
	A504 = (-2*pow(a,9)*E*L*M*(4*(49 + 27*pow(E,2))*pow(M,2) + 6*(-7 + 12*pow(E,2))*M*r - 9*pow(r,2)) + pow(a,10)*M*(3*r*(-10*M + 7*r) + 2*pow(E,2)*(98*pow(M,2) + 30*M*r - 15*pow(r,2))) - 2*a*E*L*M*pow(r,4)*(pow(L,2)*pow(r,2)*(-725*pow(M,2) + 8*(172 + 21*pow(E,2))*M*r - 570*pow(r,2)) + 3*pow(r,4)*(-135*pow(M,2) + 4*(49 + 18*pow(E,2))*M*r - 82*pow(r,2)) + 16*pow(L,4)*(2*pow(M,2) + 15*M*r - 9*pow(r,2))) - 2*pow(a,7)*E*L*M*(pow(L,2)*(324*pow(M,2) + 12*(5 + 3*pow(E,2))*M*r + 9*pow(r,2)) + 2*r*(16*(2 + 9*pow(E,2))*pow(M,3) + 6*(94 + 57*pow(E,2))*pow(M,2)*r + 2*(-65 + 126*pow(E,2))*M*pow(r,2) - 39*pow(r,3))) + pow(r,4)*(-2*pow(L,6)*M*(44*pow(M,2) - 52*M*r + 15*pow(r,2)) + 3*M*pow(r,6)*(52*pow(M,2) + (-65 + 44*pow(E,2))*M*r + (23 - 30*pow(E,2))*pow(r,2)) + 2*pow(L,4)*pow(r,2)*(-153*pow(M,3) + (271 + 140*pow(E,2))*pow(M,2)*r - 2*(82 + 39*pow(E,2))*M*pow(r,2) + 36*pow(r,3)) + pow(L,2)*pow(r,4)*(34*pow(M,3) + (51 + 428*pow(E,2))*pow(M,2)*r - (109 + 248*pow(E,2))*M*pow(r,2) + 48*pow(r,3))) - 2*pow(a,3)*E*L*M*pow(r,2)*(2*pow(L,4)*(252*pow(M,2) + 116*M*r - 63*pow(r,2)) + pow(L,2)*r*(-784*pow(M,3) + 3*(219 + 40*pow(E,2))*pow(M,2)*r + 18*(39 + 22*pow(E,2))*M*pow(r,2) - 168*pow(r,3)) - 2*pow(r,3)*(765*pow(M,3) + 2*(8 + 135*pow(E,2))*pow(M,2)*r - 3*(89 + 132*pow(E,2))*M*pow(r,2) + 119*pow(r,3))) - 2*pow(a,5)*E*L*M*r*(18*pow(L,4)*(6*M + r) + pow(L,2)*(864*pow(M,3) + 84*(15 + 2*pow(E,2))*pow(M,2)*r + 2*(-145 + 132*pow(E,2))*M*pow(r,2) - 123*pow(r,3)) + r*(-576*pow(M,4) - 1390*pow(M,3)*r + 3*(667 + 108*pow(E,2))*pow(M,2)*pow(r,2) + 4*(89 + 252*pow(E,2))*M*pow(r,3) - 61*pow(r,4))) - pow(a,2)*pow(r,2)*(4*pow(L,6)*M*(-84*pow(M,2) + 8*M*r + 23*pow(r,2)) + 3*pow(r,5)*(210*pow(M,4) + (-355 + 484*pow(E,2))*pow(M,3)*r + 12*(23 - 33*pow(E,2))*pow(M,2)*pow(r,2) + 2*(-62 + 65*pow(E,2))*M*pow(r,3) + 21*pow(r,4)) + 2*pow(L,4)*r*(392*pow(M,4) - (409 + 196*pow(E,2))*pow(M,3)*r - (39 + 584*pow(E,2))*pow(M,2)*pow(r,2) + (-41 + 167*pow(E,2))*M*pow(r,3) + 84*pow(r,4)) + pow(L,2)*pow(r,3)*(1618*pow(M,4) + (-1559 + 2272*pow(E,2))*pow(M,3)*r + (683 - 4036*pow(E,2))*pow(M,2)*pow(r,2) + (-413 + 848*pow(E,2))*M*pow(r,3) + 165*pow(r,4))) + pow(a,4)*r*(18*pow(L,6)*M*(4*M + r) + 8*pow(L,4)*(72*pow(M,4) + 18*(4 + 7*pow(E,2))*pow(M,3)*r + (-91 + 128*pow(E,2))*pow(M,2)*pow(r,2) - 4*(-4 + 5*pow(E,2))*M*pow(r,3) + 9*pow(r,4)) + 3*pow(r,3)*(44*pow(M,5) - 56*(-1 + 8*pow(E,2))*pow(M,4)*r + 2*(233 - 192*pow(E,2))*pow(M,3)*pow(r,2) + (-499 + 736*pow(E,2))*pow(M,2)*pow(r,3) + (151 - 220*pow(E,2))*M*pow(r,4) - 27*pow(r,5)) - pow(L,2)*r*(576*pow(M,5) + 4*(263 + 196*pow(E,2))*pow(M,4)*r - 13*(215 + 88*pow(E,2))*pow(M,3)*pow(r,2) - 6*(-313 + 524*pow(E,2))*pow(M,2)*pow(r,3) + 4*(-82 + 241*pow(E,2))*M*pow(r,4) + 96*pow(r,5))) + pow(a,8)*(pow(L,2)*M*(4*(49 + 162*pow(E,2))*pow(M,2) + 12*(-12 + 23*pow(E,2))*M*r + 3*(11 - 4*pow(E,2))*pow(r,2)) + r*(2*pow(E,2)*M*(32*pow(M,3) + 608*pow(M,2)*r + 286*M*pow(r,2) - 105*pow(r,3)) + 3*r*(24*pow(M,3) + 2*pow(M,2)*r + 130*M*pow(r,2) + 15*pow(r,3)))) + pow(a,6)*(6*pow(L,4)*M*(36*pow(M,2) + 2*(-1 + 18*pow(E,2))*M*r + (5 + 3*pow(E,2))*pow(r,2)) + pow(L,2)*r*(64*(1 + 27*pow(E,2))*pow(M,4) + 16*(65 + 207*pow(E,2))*pow(M,3)*r + 68*(-14 + 17*pow(E,2))*pow(M,2)*pow(r,2) + (595 - 376*pow(E,2))*M*pow(r,3) + 117*pow(r,4)) + pow(r,2)*(3*r*(-58*pow(M,4) - 45*pow(M,3)*r - 420*pow(M,2)*pow(r,2) + 173*M*pow(r,3) + 9*pow(r,4)) - 4*pow(E,2)*M*(144*pow(M,4) + 432*pow(M,3)*r - 218*pow(M,2)*pow(r,2) - 416*M*pow(r,3) + 135*pow(r,4)))))/(3.*pow(r,4)*pow(pow(a,2) + r*(-2*M + r),4));
	A520 = -(pow(r,5)*(3*pow(a,2) + r*(-4*M + r)))/(2.*pow(pow(a,2) + r*(-2*M + r),3));
	A522 = (-6*pow(a,7)*E*L*M*(4*(14 + 3*pow(E,2))*M + 23*r) + 3*pow(a,8)*(2*pow(E,2)*M*(28*M - r) + r*(43*M + 9*r)) - 2*a*E*L*M*pow(r,3)*(pow(L,2)*(64*pow(M,2) + 344*M*r - 222*pow(r,2)) + 3*pow(r,2)*(-199*pow(M,2) + 4*(79 + 18*pow(E,2))*M*r - 134*pow(r,2))) - 6*pow(a,5)*E*L*M*(4*pow(L,2)*(9*M + 2*r) + r*(12*(7 + 6*pow(E,2))*pow(M,2) + 6*(17 + 16*pow(E,2))*M*r + 7*pow(r,2))) - 6*pow(a,3)*E*L*M*r*(2*pow(L,2)*(108*pow(M,2) + 52*M*r - 33*pow(r,2)) + r*(-272*pow(M,3) + (-73 + 72*pow(E,2))*pow(M,2)*r + 2*(103 + 78*pow(E,2))*M*pow(r,2) - 116*pow(r,3))) + pow(r,3)*(-4*pow(L,4)*M*(38*pow(M,2) - 45*M*r + 13*pow(r,2)) + 6*pow(r,4)*(52*pow(M,3) + (-63 + 44*pow(E,2))*pow(M,2)*r - 6*(-3 + 5*pow(E,2))*M*pow(r,2) + 2*pow(r,3)) + pow(L,2)*pow(r,2)*(-158*pow(M,3) + (369 + 428*pow(E,2))*pow(M,2)*r - 4*(73 + 62*pow(E,2))*M*pow(r,2) + 84*pow(r,3))) + pow(a,2)*r*(24*pow(L,4)*M*(18*pow(M,2) + M*r - 7*pow(r,2)) + pow(L,2)*r*(-816*pow(M,4) + 2*(213 + 356*pow(E,2))*pow(M,3)*r + (103 + 1444*pow(E,2))*pow(M,2)*pow(r,2) + 4*(32 - 125*pow(E,2))*M*pow(r,3) - 156*pow(r,4)) - 3*pow(r,3)*(210*pow(M,4) + (-295 + 548*pow(E,2))*pow(M,3)*r + (313 - 488*pow(E,2))*pow(M,2)*pow(r,2) + 2*(-97 + 95*pow(E,2))*M*pow(r,3) + 40*pow(r,4))) + 3*pow(a,6)*(pow(L,2)*(8*(7 + 9*pow(E,2))*pow(M,2) + 8*(6 + pow(E,2))*M*r + 9*pow(r,2)) + r*(2*pow(E,2)*M*(42*pow(M,2) + 148*M*r - 37*pow(r,2)) + r*(-240*pow(M,2) + 87*M*r + 11*pow(r,2)))) + 3*pow(a,4)*(8*pow(L,4)*M*(3*M + r) + pow(L,2)*r*(12*(7 + 36*pow(E,2))*pow(M,3) + 4*(-23 + 98*pow(E,2))*pow(M,2)*r + 4*(3 - 19*pow(E,2))*M*pow(r,2) - 13*pow(r,3)) - pow(r,2)*(r*(-385*pow(M,3) + 317*pow(M,2)*r - 120*M*pow(r,2) + 42*pow(r,3)) + 2*pow(E,2)*M*(136*pow(M,3) + 144*pow(M,2)*r - 312*M*pow(r,2) + 101*pow(r,3)))))/(12.*r*pow(pow(a,2) + r*(-2*M + r),4));
	A540 = (pow(r,2)*(-72*pow(a,5)*E*L*M + 9*pow(a,6)*(4*pow(E,2)*M + r) + 12*pow(a,3)*E*L*M*r*(-12*M + 11*r) + 12*a*E*L*M*pow(r,2)*(32*pow(M,2) - 42*M*r + 17*pow(r,2)) + pow(a,4)*(36*pow(L,2)*M + r*(18*pow(E,2)*M*(4*M - 3*r) + (24*M - 13*r)*r)) + pow(r,2)*(-6*pow(L,2)*M*(32*pow(M,2) - 38*M*r + 11*pow(r,2)) + pow(r,2)*(156*pow(M,3) + (-193 + 132*pow(E,2))*pow(M,2)*r + 2*(32 - 45*pow(E,2))*M*pow(r,2) + 2*pow(r,3))) - pow(a,2)*r*(pow(L,2)*(-72*pow(M,2) + 78*M*r) + r*(12*pow(E,2)*M*(16*pow(M,2) - 23*M*r + 15*pow(r,2)) + r*(183*pow(M,2) - 196*M*r + 62*pow(r,2))))))/(48.*pow(pow(a,2) + r*(-2*M + r),4));
	A600 = pow(r,6)/pow(pow(a,2) + r*(-2*M + r),3);
	A602 = (-24*pow(a,5)*E*L*M*(5*M + r) - 16*pow(a,3)*E*L*M*r*(3*pow(L,2) - 8*pow(M,2) + 2*M*r + 3*pow(r,2)) + 8*a*E*L*M*pow(r,2)*(pow(L,2)*(4*M - 6*r) + (11*M - 15*r)*pow(r,2)) + 3*pow(a,6)*(r*(-6*M + r) + 4*pow(E,2)*M*(5*M + 3*r)) + pow(r,2)*(8*pow(L,4)*M*(-2*M + r) + M*pow(r,4)*(43*M + 4*(-8 + 5*pow(E,2))*r) + pow(L,2)*pow(r,2)*(3*pow(M,2) + 4*(3 + 4*pow(E,2))*M*r - 12*pow(r,2))) + pow(a,2)*r*(24*pow(L,4)*M + pow(r,2)*(-34*pow(M,3) + (39 - 100*pow(E,2))*pow(M,2)*r + 2*(-47 + 38*pow(E,2))*M*pow(r,2) + 36*pow(r,3)) + pow(L,2)*(-64*pow(M,3) - 8*(-3 + 2*pow(E,2))*pow(M,2)*r + 10*(-3 + 4*pow(E,2))*M*pow(r,2) + 48*pow(r,3))) + pow(a,4)*(3*pow(L,2)*(20*pow(M,2) + 4*(-1 + 2*pow(E,2))*M*r + pow(r,2)) + r*(r*(32*pow(M,2) - 14*M*r + 39*pow(r,2)) + pow(E,2)*(-64*pow(M,3) + 8*pow(M,2)*r + 92*M*pow(r,2)))))/(6.*pow(pow(a,2) + r*(-2*M + r),4));
	A620 = (pow(r,3)*(-48*pow(a,3)*E*L*M + 16*a*E*L*M*(M - 3*r)*r + 3*pow(a,4)*(8*pow(E,2)*M + 5*r) + M*r*(pow(L,2)*(-8*M + 4*r) + pow(r,2)*(43*M + 4*(-8 + 5*pow(E,2))*r)) + pow(a,2)*(24*pow(L,2)*M + 2*r*(r*(-31*M + 18*r) + pow(E,2)*(-4*pow(M,2) + 22*M*r)))))/(24.*pow(pow(a,2) + r*(-2*M + r),4));
	A700 = (pow(r,5)*(-pow(a,2) + M*r))/(2.*pow(pow(a,2) + r*(-2*M + r),4));
	A702 = (-12*pow(a,7)*E*L*M*((2 + 6*pow(E,2))*M + 3*r) + 3*pow(a,8)*(2*pow(E,2)*M*(2*M - 7*r) + r*(26*M + 3*r)) - 4*a*E*L*M*pow(r,3)*(pow(L,2)*(-52*pow(M,2) + 144*M*r - 69*pow(r,2)) + pow(r,2)*(-85*pow(M,2) + 2*(61 + 27*pow(E,2))*M*r - 51*pow(r,2))) - 8*pow(a,5)*E*L*M*(27*pow(L,2)*M + r*((35 + 12*pow(E,2))*pow(M,2) + 3*(8 + 17*pow(E,2))*M*r - 9*pow(r,2))) + M*pow(r,3)*(-4*pow(L,4)*(26*pow(M,2) - 31*M*r + 9*pow(r,2)) + pow(L,2)*pow(r,2)*(-25*pow(M,2) + 4*(3 + 44*pow(E,2))*M*r + 2*(5 - 54*pow(E,2))*pow(r,2)) + pow(r,4)*(91*pow(M,2) + 2*(-59 + 40*pow(E,2))*M*r + 2*(23 - 29*pow(E,2))*pow(r,2))) - 4*pow(a,3)*E*L*M*r*(pow(L,2)*(72*pow(M,2) + 172*M*r - 69*pow(r,2)) + r*(-80*pow(M,3) - 65*pow(M,2)*r + 2*(64 + 69*pow(E,2))*M*pow(r,2) - 84*pow(r,3))) + pow(a,2)*r*(4*pow(L,4)*M*(24*pow(M,2) + 35*M*r - 31*pow(r,2)) + pow(L,2)*r*(-160*pow(M,4) - 52*(-1 + 2*pow(E,2))*pow(M,3)*r + (27 + 1004*pow(E,2))*pow(M,2)*pow(r,2) + 2*(51 - 130*pow(E,2))*M*pow(r,3) - 84*pow(r,4)) - pow(r,3)*(166*pow(M,4) + (-289 + 532*pow(E,2))*pow(M,3)*r + (371 - 472*pow(E,2))*pow(M,2)*pow(r,2) + 16*(-17 + 14*pow(E,2))*M*pow(r,3) + 72*pow(r,4))) + pow(a,6)*(3*pow(L,2)*((4 + 72*pow(E,2))*pow(M,2) + 26*M*r + 3*pow(r,2)) + r*(4*pow(E,2)*M*(35*pow(M,2) + 88*M*r - 48*pow(r,2)) + r*(-322*pow(M,2) + 147*M*r - 9*pow(r,2)))) + pow(a,4)*(72*pow(L,4)*pow(M,2) + pow(L,2)*r*(4*(35 + 72*pow(E,2))*pow(M,3) + 4*(-40 + 239*pow(E,2))*pow(M,2)*r + (23 - 152*pow(E,2))*M*pow(r,2) - 36*pow(r,3)) - pow(r,2)*(4*pow(E,2)*M*(40*pow(M,3) + 78*pow(M,2)*r - 195*M*pow(r,2) + 79*pow(r,3)) + r*(-376*pow(M,3) + 365*pow(M,2)*r - 205*M*pow(r,2) + 90*pow(r,3)))))/(12.*r*pow(pow(a,2) + r*(-2*M + r),5));
	A720 = -(pow(r,2)*(-48*pow(a,5)*E*L*M + 4*pow(a,3)*E*L*M*(68*M - 57*r)*r + 3*pow(a,6)*(8*pow(E,2)*M + 3*r) - 4*a*E*L*M*pow(r,2)*(52*pow(M,2) - 98*M*r + 45*pow(r,2)) + M*pow(r,2)*(2*pow(L,2)*(52*pow(M,2) - 64*M*r + 19*pow(r,2)) + pow(r,2)*(-91*pow(M,2) + 2*(59 - 40*pow(E,2))*M*r + 2*(-23 + 29*pow(E,2))*pow(r,2))) + pow(a,4)*(24*pow(L,2)*M + r*(-2*pow(E,2)*M*(68*M - 65*r) + r*(-79*M + 42*r))) + pow(a,2)*r*(2*pow(L,2)*M*(-68*M + 49*r) + r*(4*pow(E,2)*M*(26*pow(M,2) - 66*M*r + 41*pow(r,2)) + r*(187*pow(M,2) - 212*M*r + 72*pow(r,2))))))/(48.*pow(pow(a,2) + r*(-2*M + r),5));
	A800 = (pow(r,3)*(-12*pow(a,3)*E*L*M + 4*a*E*L*M*(2*M - 3*r)*r + 3*pow(a,4)*(2*pow(E,2)*M + r) + M*r*(pow(L,2)*(-4*M + 2*r) + pow(r,2)*(5*M + 4*(-1 + pow(E,2))*r)) + 2*pow(a,2)*(3*pow(L,2)*M + r*(r*(-5*M + 3*r) + pow(E,2)*M*(-2*M + 5*r)))))/(12.*pow(pow(a,2) + r*(-2*M + r),5));
	A900 = -(pow(r,2)*(-18*pow(a,5)*E*L*M + 2*pow(a,3)*E*L*M*(26*M - 21*r)*r + 3*pow(a,6)*(3*pow(E,2)*M + r) - 8*a*E*L*M*pow(r,2)*(2*pow(M,2) - 6*M*r + 3*pow(r,2)) + M*pow(r,2)*(pow(L,2)*(8*pow(M,2) - 10*M*r + 3*pow(r,2)) + 2*pow(r,2)*(-5*pow(M,2) + (7 - 4*pow(E,2))*M*r + 3*(-1 + pow(E,2))*pow(r,2))) + pow(a,4)*(9*pow(L,2)*M + r*(-26*pow(E,2)*M*(M - r) + r*(-17*M + 9*r))) + pow(a,2)*r*(2*pow(L,2)*M*(-13*M + 8*r) + r*(r*(30*pow(M,2) - 35*M*r + 12*pow(r,2)) + pow(E,2)*M*(8*pow(M,2) - 38*M*r + 23*pow(r,2))))))/(24.*pow(pow(a,2) + r*(-2*M + r),6));
  }

  /* Compute aLpha, beta coefficients */
  alpha20 = r*r/(a*a+r*(r-2*M));
  alpha02 = r*r;
  beta = 4.0*(L*L + r*r + a*a*(r+2*M)/r);
}
